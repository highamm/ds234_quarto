<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title> 3 Plotting with ggplot2 | STAT 234: Data Science</title>
<meta name="author" content="Matt Higham">
<meta name="description" content="Goals: Use the ggplot2 package to make exploratory plots from STAT 113 of a single quantitative variable, two quantitative variables, a quantitative and a categorical variable, a single...">
<meta name="generator" content="bookdown 0.27 with bs4_book()">
<meta property="og:title" content=" 3 Plotting with ggplot2 | STAT 234: Data Science">
<meta property="og:type" content="book">
<meta property="og:url" content="https://highamm.github.io/datascience234/ggplot2.html">
<meta property="og:description" content="Goals: Use the ggplot2 package to make exploratory plots from STAT 113 of a single quantitative variable, two quantitative variables, a quantitative and a categorical variable, a single...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content=" 3 Plotting with ggplot2 | STAT 234: Data Science">
<meta name="twitter:description" content="Goals: Use the ggplot2 package to make exploratory plots from STAT 113 of a single quantitative variable, two quantitative variables, a quantitative and a categorical variable, a single...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.5.1/tabs.js"></script><script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="bs4_style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">STAT 234: Data Science</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Syllabus and Course Information</a></li>
<li class="book-part">The Core: tidyverse Basics</li>
<li><a class="" href="intro.html"><span class="header-section-number">2</span> Getting Started with R and R Studio</a></li>
<li><a class="active" href="ggplot2.html"><span class="header-section-number">3</span> Plotting with ggplot2</a></li>
<li><a class="" href="dplyr.html"><span class="header-section-number">4</span> Wrangling with dplyr</a></li>
<li><a class="" href="communication-with-quarto.html"><span class="header-section-number">5</span> Communication with Quarto</a></li>
<li><a class="" href="workflow.html"><span class="header-section-number">6</span> Workflow and Other Skills</a></li>
<li class="book-part">Data Wrangling</li>
<li><a class="" href="tidying-with-tidyr.html"><span class="header-section-number">7</span> Tidying with tidyr</a></li>
<li><a class="" href="coding-in-base-r.html"><span class="header-section-number">8</span> Coding in Base R</a></li>
<li><a class="" href="factors-with-forcats.html"><span class="header-section-number">9</span> Factors with forcats</a></li>
<li><a class="" href="data-ethics.html"><span class="header-section-number">10</span> Data Ethics</a></li>
<li><a class="" href="data-import.html"><span class="header-section-number">11</span> Data Import</a></li>
<li><a class="" href="merging-with-dplyr.html"><span class="header-section-number">12</span> Merging with dplyr</a></li>
<li class="book-part">Special Topics</li>
<li><a class="" href="dates-with-lubridate.html"><span class="header-section-number">13</span> Dates with lubridate</a></li>
<li><a class="" href="text-data-with-tidytext-and-stringr.html"><span class="header-section-number">14</span> Text Data with tidytext and stringr</a></li>
<li><a class="" href="predictive-modeling-with-knn.html"><span class="header-section-number">15</span> Predictive Modeling with knn</a></li>
<li><a class="" href="connections-to-stat-113-stat-213-and-cs-140.html"><span class="header-section-number">16</span> Connections to STAT 113, STAT 213, and CS 140</a></li>
<li><a class="" href="introduction-to-sql-with-dbplyr.html"><span class="header-section-number">17</span> Introduction to SQL with dbplyr</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="ggplot2" class="section level1" number="3">
<h1>
<span class="header-section-number"> 3</span> Plotting with <code>ggplot2</code><a class="anchor" aria-label="anchor" href="#ggplot2"><i class="fas fa-link"></i></a>
</h1>
<p><strong>Goals:</strong></p>
<ol style="list-style-type: decimal">
<li><p>Use the <code>ggplot2</code> package to make exploratory plots from STAT 113 of a single quantitative variable, two quantitative variables, a quantitative and a categorical variable, a single categorical variable, and two categorical variables.</p></li>
<li><p>Use the plots produced to answer questions about the Presidential election data set and the Fitness data set.</p></li>
<li><p>Further practice running code in <code>R</code>.</p></li>
</ol>
<div id="introduction-and-basic-terminology" class="section level2" number="3.1">
<h2>
<span class="header-section-number">3.1</span> Introduction and Basic Terminology<a class="anchor" aria-label="anchor" href="#introduction-and-basic-terminology"><i class="fas fa-link"></i></a>
</h2>
<p>We will begin our data science journey with plotting in the <code>ggplot2</code> package. We are starting with plotting for a couple of reasons:</p>
<ol style="list-style-type: decimal">
<li><p>Plotting is cool! We get to see an immediate result of our coding efforts in the form of a nice-to-look-at plot.</p></li>
<li><p>In an exploratory data analysis, you would typically start by making plots of your data.</p></li>
<li><p>Plotting can lead us to ask and subsequently investigate interesting questions, as we will see in our first example.</p></li>
</ol>
<p>We will first use a data set on the 2000 United States Presidential election between former President George Bush and Al Gore obtained from <a href="http://www.econometrics.com/intro/votes.htm" target="_blank">http://www.econometrics.com/intro/votes.htm</a>. For those unfamiliar with U.S. political elections, it is enough to know that each state is allocated a certain number of “electoral votes” for the president: states award all of their electoral votes to the candidate that receives the most ballots in that state. You can read more about this strange system <a href="https://en.wikipedia.org/wiki/United_States_Electoral_College" target="_blank">on Wikipedia</a>.</p>
<p>Florida is typically a highly-contentious “battleground” state. The data set that we have has the following variables, recorded for each of the 67 counties in Florida:</p>
<ul>
<li>
<code>Gore</code>, the number of people who voted for Al Gore in 2000</li>
<li>
<code>Bush</code>, the number of people who voted for George Bush in 2000</li>
<li>
<code>Buchanan</code>, the number of people who voted for the third-party candidate Buchanan</li>
<li>
<code>Nader</code>, the number of people who voted for the third-party candidate Nader</li>
<li>
<code>Other</code>, the number of people who voted for a candidate other than the previous 4 listed</li>
<li>
<code>County</code>, the name of the county in Florida</li>
</ul>
<p>To get started exploring the data, complete the following steps that you learned in Week 0:</p>
<ol style="list-style-type: decimal">
<li><p>Open your <code>R Project</code> by double clicking the <code>.RProj</code> icon in the folder on your desktop, or, by opening <code>R Studio</code> and clicking <code>File -&gt; Open Project</code>.</p></li>
<li><p>Create a new .qmd file in the same folder as your Notes <code>R Project</code> using File -&gt; New File -&gt; <code>Quarto</code>.</p></li>
<li><p>Finally, read in and name the data set <code>pres_df</code>, and take a look at the data set by running the <code>head(pres_df)</code> line, which shows the first few observations of the data set:</p></li>
</ol>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="va">pres_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_table.html">read_table</a></span><span class="op">(</span><span class="st">"data/PRES2000.txt"</span><span class="op">)</span> </span>
<span><span class="co">## don't worry about the `read_table` function....yet</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">pres_df</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 6</span></span>
<span><span class="co">#&gt;     Gore   Bush Buchanan Nader Other County  </span></span>
<span><span class="co">#&gt;    &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   </span></span>
<span><span class="co">#&gt; 1  47365  34124      263  3226   751 ALACHUA </span></span>
<span><span class="co">#&gt; 2   2392   5610       73    53    26 BAKER   </span></span>
<span><span class="co">#&gt; 3  18850  38637      248   828   242 BAY     </span></span>
<span><span class="co">#&gt; 4   3075   5414       65    84    35 BRADFORD</span></span>
<span><span class="co">#&gt; 5  97318 115185      570  4470   852 BREVARD </span></span>
<span><span class="co">#&gt; 6 386561 177323      788  7101  1623 BROWAR</span></span></code></pre></div>
<p>Pay special attention to the variable names: we’ll need to use these names when we make all of our plots. And, <code>R</code> is case-sensitive, meaning that we will, for example, need to use <code>Gore</code>, not <code>gore</code>.</p>
<p>We are trying to go very light on the technical code terminology to start out with (but we will come back to some things later in the semester). The terminology will make a lot more sense once you’ve actually worked with data. But, there are three terms that will be thrown around quite a bit in the next few weeks: <em>function</em>, <em>argument</em>, and <em>object</em>.</p>
<ul>
<li><p>a <em>function</em> in <code>R</code> is always* (*always for this class) followed by an open <code>(</code> and ended with a closed <code>)</code>. In non-technical terms, a <em>function</em> <strong>does</strong> something to its inputs and is often analogous to an English verb. For example, the <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code> function calculates the mean, the <code><a href="https://rdrr.io/r/base/rank.html">rank()</a></code> functions ranks a variable from lowest to highest, and the <code><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs()</a></code> is used to add labels to a plot. Every function has a help file that can be accessed by typing in <code>?name_of_function</code>. Try typing <code><a href="https://rdrr.io/r/base/mean.html">?mean</a></code> in your lower left window.</p></li>
<li><p>an <em>argument</em> is something that goes inside the parentheses in a function. Arguments could include <em>objects</em>, or they might not. In the bottom-left window, type <code><a href="https://rdrr.io/r/base/mean.html">?mean</a></code> to view the Help file on this <code>R</code> function. We see that <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code> has 3 arguments: <code>x</code>, which is an <code>R</code> object, <code>trim</code>, and <code>na.rm</code>. <code>trim = 0</code> is the default, which means that, by default, <code>R</code> will not trim any of the numbers when computing the mean.</p></li>
<li><p>an <em>object</em> is something created in <code>R</code>, usually with <code>&lt;-</code>. So, looking at the code above where we read in the data, <code>pres_df</code> is an <code>R</code> object.</p></li>
</ul>
<p>All of this will make more sense as we go through these first couple of weeks.</p>
</div>
<div id="basic-plot-structure" class="section level2" number="3.2">
<h2>
<span class="header-section-number">3.2</span> Basic Plot Structure<a class="anchor" aria-label="anchor" href="#basic-plot-structure"><i class="fas fa-link"></i></a>
</h2>
<p>We will use the <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> function in the <code>ggplot2</code> package to construct visualizations of data. the <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> function has 3 basic components:</p>
<ul>
<li>a <code>data</code> argument, specifying the name of your data set (<code>pres_df</code> above)</li>
<li>a <code>mapping</code> argument, specifying that specifies the aesthetics of your plot (<code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>). Common aesthetics are <code>x</code> position, <code>y</code> position, <code>colour</code>, <code>size</code>, <code>shape</code>, <code>group</code>, and <code>fill</code>.</li>
<li>a <code>geom_    ()</code> component, specifying the geometric shape used to display the data.</li>
</ul>
<p>The components are combined in the following form:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="ggplot2.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> name_of_data, <span class="fu">aes</span>(<span class="at">x =</span> name_of_x_var, </span>
<span id="cb27-2"><a href="ggplot2.html#cb27-2" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">y =</span> name_of_y_var,</span>
<span id="cb27-3"><a href="ggplot2.html#cb27-3" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">colour =</span> name_of_colour_var,</span>
<span id="cb27-4"><a href="ggplot2.html#cb27-4" aria-hidden="true" tabindex="-1"></a>                                          etc.)) <span class="sc">+</span></span>
<span id="cb27-5"><a href="ggplot2.html#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_nameofgeom</span>() <span class="sc">+</span></span>
<span id="cb27-6"><a href="ggplot2.html#cb27-6" aria-hidden="true" tabindex="-1"></a>  .....<span class="sc">&lt;</span>other stuff<span class="sc">&gt;</span></span></code></pre></div>
<p>The structure of <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> plots is based on the Grammar of Graphics <a href="https://www.springer.com/gp/book/9780387245447" target="_blank">https://www.springer.com/gp/book/9780387245447</a>. As with most new things, the components above will be easier to think about with some examples.</p>
</div>
<div id="graphing-a-single-variable" class="section level2" number="3.3">
<h2>
<span class="header-section-number">3.3</span> Graphing a Single Variable<a class="anchor" aria-label="anchor" href="#graphing-a-single-variable"><i class="fas fa-link"></i></a>
</h2>
<div id="histograms-and-frequency-plots-for-a-quantitative-variable" class="section level3" number="3.3.1">
<h3>
<span class="header-section-number">3.3.1</span> Histograms and Frequency Plots for a Quantitative Variable<a class="anchor" aria-label="anchor" href="#histograms-and-frequency-plots-for-a-quantitative-variable"><i class="fas fa-link"></i></a>
</h3>
<p>Let’s go ahead and begin our exploration of the data by making a histogram of the number of people who voted for <code>Gore</code> in each county. Recall that a histogram is useful if we would like a graph of a single quantitative variable. Copy the following code to an <code>R</code> chunk and run the code:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pres_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Gore</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Votes for Gore in Florida"</span><span class="op">)</span></span>
<span><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with</span></span>
<span><span class="co">#&gt; `binwidth`.</span></span></code></pre></div>
<div class="inline-figure"><img src="02-ggplot2_files/figure-html/unnamed-chunk-3-1.png" width="672"></div>
<p>What do the 1e+05, 2e+05, etc. labels on the x-axis mean?</p>
<p><code>R</code> gives us a message to “Pick a better value with <code>binwidth</code>” instead of the default <code>bins = 30</code>. Add <code>, bins = 15</code> inside the parentheses of <code><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram()</a></code> to change the number of bins in the histogram.</p>
<p>Change the colour of the inside of the bins to “darkred”. Do you think that the colour of the inside of the bins maps to <code>colour</code> or <code>fill</code>? Try both!</p>
<p>There are a couple of observations with very high vote values. What could explain these large outliers?</p>
<p><br></p>
<p>Another graph useful in visualizing a single quantitative variable is a frequency plot. The code to make a frequency plot is given below. We are simply replacing <code><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram()</a></code> with <code><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_freqpoly()</a></code>.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pres_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Gore</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_freqpoly</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Votes for Gore in Florida"</span><span class="op">)</span> </span>
<span><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with</span></span>
<span><span class="co">#&gt; `binwidth`.</span></span></code></pre></div>
<div class="inline-figure"><img src="02-ggplot2_files/figure-html/unnamed-chunk-4-1.png" width="672"></div>
<p>The frequency plot is just like a histogram but the counts are connected by a line instead of represented with bins. You can see how they relate by including <strong>both</strong> a geom_freqpoly() and a geom_histogram() in your plot, though it doesn’t make for the prettiest graph:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pres_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Gore</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_freqpoly</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Votes for Gore in Florida"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="op">)</span> </span>
<span><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with</span></span>
<span><span class="co">#&gt; `binwidth`.</span></span>
<span><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with</span></span>
<span><span class="co">#&gt; `binwidth`.</span></span></code></pre></div>
<div class="inline-figure"><img src="02-ggplot2_files/figure-html/unnamed-chunk-5-1.png" width="672"></div>
</div>
<div id="r-code-style" class="section level3" number="3.3.2">
<h3>
<span class="header-section-number">3.3.2</span> <code>R</code> Code Style<a class="anchor" aria-label="anchor" href="#r-code-style"><i class="fas fa-link"></i></a>
</h3>
<p>We want our code to be as readable as possible. This not only benefits other people who may read your code (like me), but it also benefits you, particularly if you read your own code in the future. I try to follow the Style Guide in the Advanced <code>R</code> book: <a href="http://adv-r.had.co.nz/Style.html" target="_blank">http://adv-r.had.co.nz/Style.html</a>. Feel free to skim through that, but you don’t need to worry about it too much: you should be able to pick up on some important elements just from going through this course. You might actually end up having better code style if you <em>haven’t</em> had any previous coding experience.</p>
<p>As a quick example of why code style can be important, consider the following two code chunks, both of which produce the same graph.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">pres_df</span>,mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Gore</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>colour<span class="op">=</span><span class="st">"black"</span>,fill<span class="op">=</span><span class="st">"white"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Votes for Gore in Florida"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pres_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Gore</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Votes for Gore in Florida"</span><span class="op">)</span></span></code></pre></div>
<p>Which code chunk would you want to read two years from now? Which code chunk would you want your classmate/friend/coworker to read? (assuming you like your classmate/friend/coworker….)</p>
</div>
<div id="bar-plots-for-a-categorical-variable" class="section level3" number="3.3.3">
<h3>
<span class="header-section-number">3.3.3</span> Bar Plots for a Categorical Variable<a class="anchor" aria-label="anchor" href="#bar-plots-for-a-categorical-variable"><i class="fas fa-link"></i></a>
</h3>
<p>Recall from STAT 113 that bar plots are useful if you want to examine the distribution of one categorical variable. Side-by-side bar plots or stacked bar plots are plots that are useful for looking at the relationship between two categorical variables. There actually aren’t any categorical variables that would be interesting to plot in this data set, so we’ll make one, called <code>winner</code> using code that we don’t need to understand until next week. <code>winner</code> will be <code>"Gore"</code> if Gore won the county and <code>"Bush"</code> if Bush won the county. We’ll name this new data set <code>pres_cat</code>.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pres_cat</span> <span class="op">&lt;-</span> <span class="va">pres_df</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>winner <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="va">Gore</span> <span class="op">&gt;</span> <span class="va">Bush</span>,</span>
<span>                                                true <span class="op">=</span> <span class="st">"Gore"</span>,</span>
<span>                                                false <span class="op">=</span> <span class="st">"Bush"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pres_cat</span></span>
<span><span class="co">#&gt; # A tibble: 67 × 7</span></span>
<span><span class="co">#&gt;      Gore   Bush Buchanan Nader Other County    winner</span></span>
<span><span class="co">#&gt;     &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt; </span></span>
<span><span class="co">#&gt;  1  47365  34124      263  3226   751 ALACHUA   Gore  </span></span>
<span><span class="co">#&gt;  2   2392   5610       73    53    26 BAKER     Bush  </span></span>
<span><span class="co">#&gt;  3  18850  38637      248   828   242 BAY       Bush  </span></span>
<span><span class="co">#&gt;  4   3075   5414       65    84    35 BRADFORD  Bush  </span></span>
<span><span class="co">#&gt;  5  97318 115185      570  4470   852 BREVARD   Bush  </span></span>
<span><span class="co">#&gt;  6 386561 177323      788  7101  1623 BROWAR    Gore  </span></span>
<span><span class="co">#&gt;  7   2155   2873       90    39    17 CALHOUN   Bush  </span></span>
<span><span class="co">#&gt;  8  29645  35426      182  1462   181 CHARLOTTE Bush  </span></span>
<span><span class="co">#&gt;  9  25525  29765      270  1379   261 CITRUS    Bush  </span></span>
<span><span class="co">#&gt; 10  14632  41736      186   562   237 CLAY      Bush  </span></span>
<span><span class="co">#&gt; # … with 57 more rows</span></span>
<span><span class="co">#&gt; # ℹ Use `print(n = ...)` to see more rows</span></span></code></pre></div>
<p>Using this data set, we can make a bar plot with <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code>. The beauty of <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> is that the code is super-similar to what we used for histograms and frequency plots!</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pres_cat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">winner</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="02-ggplot2_files/figure-html/unnamed-chunk-9-1.png" width="672"></div>
<p>Note that, sometimes, data are in format such that one column contains the <em>levels</em> of the categorical variable while another column contains the counts directly. For example, we can create such a data set using code that we will learn next week:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pres_cat2</span> <span class="op">&lt;-</span> <span class="va">pres_cat</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">winner</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>nwins <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pres_cat2</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 2</span></span>
<span><span class="co">#&gt;   winner nwins</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;  &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1 Bush      51</span></span>
<span><span class="co">#&gt; 2 Gore      16</span></span></code></pre></div>
<p>This data set has just two observations and contains a column for the two major presidential candidates and a column for the number of counties that each candidate won. If we wanted to make a barplot showing the number of wins for each candidate, we can’t use <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code>. Predict what the result will be from running the following code.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">pres_cat2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">winner</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Instead, we can use <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col()</a></code>, which takes an <code>x</code> aesthetic giving the column with names of the levels of our categorical variable, and a <code>y</code> aesthetic giving the column with the counts:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">pres_cat2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">winner</span>, y <span class="op">=</span> <span class="va">nwins</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="02-ggplot2_files/figure-html/unnamed-chunk-12-1.png" width="672"></div>
</div>
<div id="exercise-2-1" class="section level3" number="3.3.4">
<h3>
<span class="header-section-number">3.3.4</span> Exercises<a class="anchor" aria-label="anchor" href="#exercise-2-1"><i class="fas fa-link"></i></a>
</h3>
<p>Exercises marked with an * indicate that the exercise has a solution at the end of the chapter at <a href="ggplot2.html#solutions-2">3.7</a>.</p>
<ol style="list-style-type: decimal">
<li><p>Change the frequency plot to plot the number of votes for Bush instead of the number for Gore. Are there any obvious outliers in the Bush frequency plot?</p></li>
<li><p>Do you have a preference for histograms or a preference for frequency plots? Can you think of a situation where one would be more desirable than the other?</p></li>
<li><p>It looks like Bush won a lot more….does that necessarily mean that Bush won more votes in total in Florida? Why or why not?</p></li>
</ol>
<p>We will be using survey data from STAT 113 in the 2018-2019 academic year for many exercises in this section. For those who may not have taken STAT 113 from having AP credit or another reason, the STAT 113 survey is given to all students in STAT 113 across all sections. Some analyses in Intro Stat are then carried out using the survey.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="va">stat113_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"data/stat113.csv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">stat113_df</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 12</span></span>
<span><span class="co">#&gt;   Year   Sex     Hgt   Wgt Haircut   GPA Exerc…¹ Sport    TV</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;  &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 Sopho… M        66   155       0  2.9       15 Yes       8</span></span>
<span><span class="co">#&gt; 2 First… F        69   170      17  3.87      14 Yes      12</span></span>
<span><span class="co">#&gt; 3 First… F        64   130      40  3.3        5 No        5</span></span>
<span><span class="co">#&gt; 4 First… M        68   157      35  3.21      10 Yes      15</span></span>
<span><span class="co">#&gt; 5 First… M        72   175      20  3.1        2 No        5</span></span>
<span><span class="co">#&gt; 6 Junior F        62   150      50  3.3        8 Yes       5</span></span>
<span><span class="co">#&gt; # … with 3 more variables: Award &lt;chr&gt;, Pulse &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   SocialMedia &lt;chr&gt;, and abbreviated variable name</span></span>
<span><span class="co">#&gt; #   ¹​Exercise</span></span>
<span><span class="co">#&gt; # ℹ Use `colnames()` to see all variable names</span></span></code></pre></div>
<p>The data set contains the following variables:</p>
<ul>
<li>
<code>Year</code>, FirstYear, Sophomore, Junior, or Senior</li>
<li>
<code>Sex</code>, M or F (for this data set, <code>Sex</code> is considered binary).</li>
<li>
<code>Hgt</code>, height, in inches.</li>
<li>
<code>Wgt</code>, weight, in pounds.</li>
<li>
<code>Haircut</code>, how much is paid for a haircut, typically.</li>
<li><code>GPA</code></li>
<li>
<code>Exercise</code>, amount of hours of exercise in a typical week.</li>
<li>
<code>Sport</code>, whether or not the student plays a varsity sport.</li>
<li>
<code>TV</code>, amount of hours spent watching TV in a typical week.</li>
<li>
<code>Award</code>, Award preferred: choices are Olympic Medal, Nobel Prize, or Academy Award.</li>
<li>
<code>Pulse</code>, pulse rate, in beats per minute.</li>
<li>
<code>SocialMedia</code>, most used social media platform (Instagram, SnapChat, FaceBook, Twitter, Other, or None).</li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li><p>* Create a histogram of the <code>Exercise</code> variable, change the x-axis label to be “Exercise (hours per typical week)”, change the number of <code>bins</code> to <code>14</code>, and change the <code>fill</code> of the bins to be “lightpink2” and the outline <code>colour</code> of the bins to be black.</p></li>
<li><p>* We can change the y-axis of a histogram to be “density” instead of a raw count. This means that each bar shows a <strong>proportion</strong> of cases instead of a raw count. Google something like “geom_histogram with density” to figure out how to create a y <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> to show density instead of count.</p></li>
<li><p>Construct a histogram using a quantitative variable of your choice. Change the <code>fill</code> and <code>colour</code> using <a href="http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf" target="_blank">http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf</a> to help you choose colours.</p></li>
<li><p>Construct a bar plot for a variable of your choosing. What do you find?</p></li>
<li><p>What format would the STAT 113 data set need to be in to construct your bar plot with <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col()</a></code> instead of <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code>?</p></li>
</ol>
</div>
</div>
<div id="graphing-two-quantitative-variables-faceting-and-aes-options" class="section level2" number="3.4">
<h2>
<span class="header-section-number">3.4</span> Graphing Two Quantitative Variables, Faceting, and <code>aes()</code> Options<a class="anchor" aria-label="anchor" href="#graphing-two-quantitative-variables-faceting-and-aes-options"><i class="fas fa-link"></i></a>
</h2>
<div id="scatterplots" class="section level3" number="3.4.1">
<h3>
<span class="header-section-number">3.4.1</span> Scatterplots<a class="anchor" aria-label="anchor" href="#scatterplots"><i class="fas fa-link"></i></a>
</h3>
<p>Moving back to the 2000 presidential election data set, thus far, we’ve figured out that there a couple of counties with very large numbers of votes for Gore and very large number of votes for Bush. We don’t know the reason for this (if some counties are very democratic, very republican, or if some counties are just more populous). Do the counties that have a large number of votes for Bush also tend to have a large number of votes for Gore? And what about the other candidates: do they have any interesting patterns?</p>
<p>Let’s start by making a scatterplot of the number of votes for Gore and the number of votes for Bush. Note that the <code>geom_</code> for making a scatterplot is called <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code> because we are adding a layer of points to the plot.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pres_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Gore</span>, y <span class="op">=</span> <span class="va">Bush</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="02-ggplot2_files/figure-html/unnamed-chunk-16-1.png" width="672"></div>
<p>What patterns do you see in the scatterplot?</p>
<p>Now, change the x variable from <code>Gore</code> to <code>Buchanan</code>. You should notice something strange in this scatterplot. Try to come up with one explanation for why the outlying point has so many votes for <code>Buchanan</code>.</p>
<p>In trying to come up with an explanation, it would be nice to figure out which Florida county has that outlying point and it would be nice if we knew something about Florida counties. To remedy the first issue, recall that we can type <code>View(pres_df)</code> to pull up the data set. Once you have the new window open, click on the column heading <code>Buchanan</code> to sort the votes for Buchanan from high to low to figure out which county is the outlier.</p>
<p>Use some Google sleuthing skills to find an explanation: try to search for “2000 united states presidential election [name of outlier county]”. Write a sentence about what you find. Hint: if nothing useful pops up, try adding the term “butterfly ballot” to your search.</p>
<p><br></p>
<p>We have used the 2000 Presidential data set to find out something really interesting! In particular, we have used <em>exploratory data analysis</em> to examine a data set, without having a specific question of interest that we want to answer. This type of exploring is often really useful, but does have some drawbacks, which we will discuss later in the semester.</p>
</div>
<div id="aesthetics-in-aes" class="section level3" number="3.4.2">
<h3>
<span class="header-section-number">3.4.2</span> Aesthetics in <code>aes()</code><a class="anchor" aria-label="anchor" href="#aesthetics-in-aes"><i class="fas fa-link"></i></a>
</h3>
<p>For the remainder of this chapter, we will work with some fitness data collected from my Apple Watch since November 2018. The <code>higham_fitness_clean.csv</code> contains information on the following variables:</p>
<ul>
<li>
<code>Start</code>, the month, day, and year that the fitness data was recorded on</li>
<li>
<code>month</code>, the month</li>
<li>
<code>weekday</code>, the day of the week</li>
<li>
<code>dayofyear</code>, the day of the year (so that 304 corresponds to the 304th day of the year)</li>
<li>
<code>distance</code>, distance walked in miles</li>
<li>
<code>steps</code>, the number of steps taken</li>
<li>
<code>flights</code>, the number of flights of stairs climbed</li>
<li>
<code>active_cals</code>, the number of calories burned from activity</li>
<li>
<code>stepgoal</code>, whether or not I reached 10,000 steps for the day</li>
<li>
<code>weekend_ind</code>, a variable for whether or not the day of the week was a weekend day (Saturday or Sunday) or a weekday (Monday - Friday).</li>
</ul>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="va">fitness_full</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"data/higham_fitness_clean.csv"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>weekend_ind <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span><span class="va">weekday</span> <span class="op">==</span> <span class="st">"Sat"</span> <span class="op">|</span> <span class="va">weekday</span> <span class="op">==</span> <span class="st">"Sun"</span> <span class="op">~</span> <span class="st">"weekend"</span>,</span>
<span>  <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"weekday"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 993 Columns: 9</span></span>
<span><span class="co">#&gt; ── Column specification ────────────────────────────────────</span></span>
<span><span class="co">#&gt; Delimiter: ","</span></span>
<span><span class="co">#&gt; chr  (2): month, weekday</span></span>
<span><span class="co">#&gt; dbl  (6): active_cals, distance, flights, steps, dayofye...</span></span>
<span><span class="co">#&gt; date (1): Start</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ℹ Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">#&gt; ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span></code></pre></div>
<p>First, let’s make a basic scatterplot to illustrate why it’s so important to plot your data. I’ll use the variable <code>distance</code> as the x-variable and <code>active_cals</code> as the y-variable.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">fitness_full</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">distance</span>, y <span class="op">=</span> <span class="va">active_cals</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="02-ggplot2_files/figure-html/unnamed-chunk-18-1.png" width="672"></div>
<p>One aspect of the plot that you may notice is that there are observations where I burned 0 or very few active calories, yet walked/jogged/ran/moved some distance. Is it possible to not burn any calories and move ~ 4 miles? Probably not, so let’s drop these observations from the data set and make a note of why we dropped those observations. Unfortunately, we don’t have the tools to do this yet, so just run the following chunk of code without worrying too much about the syntax.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## drop observations that have active calories &lt; 50. </span></span>
<span><span class="co">## assuming that these are data errors or </span></span>
<span><span class="co">## days where the Apple Watch wasn't worn.</span></span>
<span><span class="va">fitness</span> <span class="op">&lt;-</span> <span class="va">fitness_full</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">active_cals</span> <span class="op">&gt;</span> <span class="fl">50</span><span class="op">)</span></span></code></pre></div>
<p>Let’s make the plot again with the <code>fitness</code> data set instead of <code>fitness_full</code> to see if the outliers are actually gone. This time, we will put the <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> in the <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code> function:</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">fitness</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">distance</span>, y <span class="op">=</span> <span class="va">active_cals</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="02-ggplot2_files/figure-html/unnamed-chunk-20-1.png" width="672"></div>
<p>Putting the <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> in <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> and putting the <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> in <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code> results in the same graph in this case. When you put the <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> in <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>, <code>R</code> perpetuates these <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> aesthetics in all <code>geom_</code>s in your plotting command. However, if you put your <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> in <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code>, then any future <code>geom</code>s that you use will need you to re-specify different <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>. We’ll see an example of this in the exercises.</p>
<p><strong>Other <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> Options</strong></p>
<p>In addition to <code>x</code> and <code>y</code>, we can also use <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> to map variables to things like <code>colour</code>, <code>size</code>, and <code>shape</code>. For example, we might make a scatterplot with <code>Start</code> on the x-axis (for the date) and <code>active_cals</code> on the y-axis, colouring by whether or not the day of the week was a weekend.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">fitness</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Start</span>, y <span class="op">=</span> <span class="va">active_cals</span>, colour <span class="op">=</span> <span class="va">weekend_ind</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="02-ggplot2_files/figure-html/unnamed-chunk-21-1.png" width="672"></div>
<p>Is there anything useful that you notice about the plot? Is there anything about the plot that could be improved?</p>
<p>Instead of using colour, you can also specify the point shape. This could be useful, for example, if you are printing something in black and white.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">fitness</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Start</span>, y <span class="op">=</span> <span class="va">active_cals</span>, shape <span class="op">=</span> <span class="va">weekend_ind</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="02-ggplot2_files/figure-html/unnamed-chunk-22-1.png" width="672"></div>
<p>Do you prefer the colour or the shape? Why?</p>
<p>Finally, another common <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> is <code>size</code>. For example, we could make the size of the points in the scatterplot change depending on how many <code>flights</code> of stairs I climbed.</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">fitness</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Start</span>, y <span class="op">=</span> <span class="va">active_cals</span>, size <span class="op">=</span> <span class="va">flights</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="02-ggplot2_files/figure-html/unnamed-chunk-23-1.png" width="672"></div>
<p>I don’t think any of the previous three plots are necessarily the “best” and need some work, but, part of the fun of exploratory data analysis is making trying out different plots to see what “works.”</p>
<p><strong>Inside vs Outside <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code></strong></p>
<p>We’ve changed the colour of the points to correspond to <code>weekend_ind</code>, but what if we just wanted to change the colour of points to all be the same colour, <code>"purple"</code>. Try running the following code chunk:</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">fitness</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Start</span>, y <span class="op">=</span> <span class="va">active_cals</span>, colour <span class="op">=</span> <span class="st">"purple"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="02-ggplot2_files/figure-html/unnamed-chunk-24-1.png" width="672"></div>
<p>What does the graph look like? Did it do what you expected?</p>
<p>Putting <code>colour = ____</code> inside <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> or outside <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> achieves different things. In general,</p>
<ul>
<li><p>when we want to map something in our data set (<code>fitness</code>) to something in our plot (<code>x</code>, <code>y</code>, <code>colour</code>, <code>size</code>, etc.), we put that <strong>inside</strong> the <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> as in <code>geom_point(aes(colour = weekend_ind))</code>.</p></li>
<li><p>When we assign fixed characteristics that don’t come from the data, we put them <strong>outside</strong> the <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>, as in <code>geom_point(colour = "purple")</code>.</p></li>
</ul>
<p>You can also change the overall point size and shape. The standard size is <code>1</code> so the following code chunk makes the points bigger. The standard shape is <code>19</code>: you can try changing that to other integers to see what other shapes you can get.</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">fitness</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Start</span>, y <span class="op">=</span> <span class="va">active_cals</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">1.5</span>, shape <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="02-ggplot2_files/figure-html/unnamed-chunk-25-1.png" width="672"></div>
</div>
<div id="using-more-than-one-geom" class="section level3" number="3.4.3">
<h3>
<span class="header-section-number">3.4.3</span> Using More Than One <code>geom()</code><a class="anchor" aria-label="anchor" href="#using-more-than-one-geom"><i class="fas fa-link"></i></a>
</h3>
<p>We might also be interested in fitting a smooth curve to our scatterplot. When we want to put more than one “geom” on our plot, we can use multiple <code>geoms</code>. Since I want the <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> to apply to <strong>both</strong> <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code> and <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth()</a></code>, I am going to move the <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> command to the overall <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> line of code:</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">fitness</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Start</span>, y <span class="op">=</span> <span class="va">active_cals</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>span <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using method = 'loess' and formula 'y ~ x'</span></span></code></pre></div>
<div class="inline-figure"><img src="02-ggplot2_files/figure-html/unnamed-chunk-26-1.png" width="672"></div>
<p>Within <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth()</a></code>, you can set <code>se = FALSE</code> to get rid of the grey standard errors around each of the lines, and you can set<code>method = "lm"</code> to fit straight linear regression lines instead of smooth curves:</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">fitness</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Start</span>, y <span class="op">=</span> <span class="va">active_cals</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>se <span class="op">=</span> <span class="cn">FALSE</span>, method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula 'y ~ x'</span></span></code></pre></div>
<div class="inline-figure"><img src="02-ggplot2_files/figure-html/unnamed-chunk-27-1.png" width="672"></div>
<p>Does it look like there is an increasing overall trend? decreasing? Does it make sense to use a line to model the relationship or did you prefer the smooth curve?</p>
</div>
<div id="line-plots-with-geom_line" class="section level3" number="3.4.4">
<h3>
<span class="header-section-number">3.4.4</span> Line Plots with <code>geom_line()</code><a class="anchor" aria-label="anchor" href="#line-plots-with-geom_line"><i class="fas fa-link"></i></a>
</h3>
<p>Line plots are often useful when you have a quantitative variable that you’d like to explore over time. The y-axis is the quantitative variable while the x-axis is typically time. More generally, line plots are often used when the x-axis variable has one discrete value for each y-axis variable. For example, suppose we want to explore how my step count has changed through time over the past couple of years. Compare the standard scatterplot with the following line plot: which do you prefer?</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">fitness</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Start</span>, y <span class="op">=</span> <span class="va">steps</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Date"</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using method = 'loess' and formula 'y ~ x'</span></span></code></pre></div>
<div class="inline-figure"><img src="02-ggplot2_files/figure-html/unnamed-chunk-28-1.png" width="672"></div>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">fitness</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Start</span>, y <span class="op">=</span> <span class="va">steps</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Date"</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using method = 'loess' and formula 'y ~ x'</span></span></code></pre></div>
<div class="inline-figure"><img src="02-ggplot2_files/figure-html/unnamed-chunk-28-2.png" width="672"></div>
<p>Can you spot the start of the pandemic in the graph? What seemed to happen with the step count?</p>
</div>
<div id="faceting" class="section level3" number="3.4.5">
<h3>
<span class="header-section-number">3.4.5</span> Faceting<a class="anchor" aria-label="anchor" href="#faceting"><i class="fas fa-link"></i></a>
</h3>
<p>Using colour to colour points of different levels of a categorical variable is generally fine when there are just a couple of levels and/or there is little overlap among the levels. But, what if there are a lot more than two categories to colour by. For example, let’s move back to the STAT 113 survey data set and investigate the relationship between <code>Pulse</code> and <code>Exercise</code> for different class <code>Year</code>’s. We might hypothesize that students who get more exercise tend to have lower pulse rates.</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">stat113_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Exercise</span>, y <span class="op">=</span> <span class="va">Pulse</span>,</span>
<span>                           colour <span class="op">=</span> <span class="va">Year</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>se <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using method = 'loess' and formula 'y ~ x'</span></span></code></pre></div>
<div class="inline-figure"><img src="02-ggplot2_files/figure-html/unnamed-chunk-29-1.png" width="672"></div>
<p>When there are many different categories for a categorical variable (there are only 4 categories for <code>Year</code>, but this particular plot is still a bit difficult to read), it can sometimes be useful to <code>facet</code> the plot by that variable instead of trying to use different <code>colour</code>s or <code>shape</code>s.</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">stat113_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Exercise</span>, y <span class="op">=</span> <span class="va">Pulse</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>se <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">Year</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using method = 'loess' and formula 'y ~ x'</span></span></code></pre></div>
<div class="inline-figure"><img src="02-ggplot2_files/figure-html/unnamed-chunk-30-1.png" width="672"></div>
<p>We have eliminated the <code>colour =</code> argument and added <code>facet_wrap( ~ name_of_facet_variable)</code>. Doing so creates a different scatterplot and smooth line for each level of <code>name_of_facet_variable</code>.</p>
<p>What can you see from this plot that was harder to see from the plot with colour?</p>
<p>Does the data seem to support the hypothesis that more exercise is associated with lower pulse rates in this sample of students?</p>
</div>
<div id="exercise-2-2" class="section level3" number="3.4.6">
<h3>
<span class="header-section-number">3.4.6</span> Exercises<a class="anchor" aria-label="anchor" href="#exercise-2-2"><i class="fas fa-link"></i></a>
</h3>
<p>Exercises marked with an * indicate that the exercise has a solution at the end of the chapter at <a href="ggplot2.html#solutions-2">3.7</a>.</p>
<ol style="list-style-type: decimal">
<li><p>Fix the code chunk where we tried to specify the colour of all points to be purple to actually make all of the points “purple” by moving <code>colour = "purple"</code> outside the parentheses in <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> (but still inside <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code>).</p></li>
<li><p>In the console (bottom-left) window, type <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">?geom_smooth</a></code> and scroll down to “Arguments.” Find <code>span</code>, read about it, and then, within the <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth()</a></code> argument of the line plot with steps vs. date, add a <code>span</code> argument to make the smooth line wigglier.</p></li>
<li><p>Explain why it doesn’t make sense to construct a line plot of <code>Exercise</code> vs. <code>GPA</code>.</p></li>
<li><p>* Make a scatterplot of <code>Hgt</code> on the y-axis and <code>Wgt</code> on the x-axis, colouring by <code>Sport</code>. Add a smooth fitted curve to your scatterplot. Then, move <code>colour = Sport</code> from an <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> in the <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> function to an <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> in the <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code> function. What changes in the plot? Can you give an explanation as to why that change occurs?</p></li>
<li><p>* Faceting can be used for other types of plots too! Make a pair of faceted histograms for a quantitative variable of your choosing that are faceted by a categorical variable of your choosing.</p></li>
</ol>
<p><br></p>
</div>
</div>
<div id="boxplots-stacked-barplots-and-others" class="section level2" number="3.5">
<h2>
<span class="header-section-number">3.5</span> Boxplots, Stacked Barplots and Others<a class="anchor" aria-label="anchor" href="#boxplots-stacked-barplots-and-others"><i class="fas fa-link"></i></a>
</h2>
<p>There are a few other common geoms that will be useful throughout the semester. These only skim the surface: we’ll come back to plotting in a few weeks, after we’re able to do more with data wrangling and reshaping.</p>
<div id="graphing-a-quant.-variable-vs.-a-cat.-variable" class="section level3" number="3.5.1">
<h3>
<span class="header-section-number">3.5.1</span> Graphing a Quant. Variable vs. a Cat. Variable<a class="anchor" aria-label="anchor" href="#graphing-a-quant.-variable-vs.-a-cat.-variable"><i class="fas fa-link"></i></a>
</h3>
<p>Another common plot used in Intro Stat courses is a boxplot. Side-by-side boxplots are particularly useful if you want to compare a quantitative response variable across two or more levels of a categorical variable. Let’s stick with the STAT 113 survey data to examine the relationship between <code>Exercise</code> and <code>Award</code> preference.</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">stat113_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Award</span>, y <span class="op">=</span> <span class="va">Exercise</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="02-ggplot2_files/figure-html/unnamed-chunk-31-1.png" width="672"></div>
<p>What can you conclude from the plot?</p>
<p><br></p>
<p>An alternative to side-by-side boxplots are violin plots:</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">stat113_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Award</span>, y <span class="op">=</span> <span class="va">Exercise</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="02-ggplot2_files/figure-html/unnamed-chunk-32-1.png" width="672"></div>
<p>Read about Violin plots by typing <code><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">?geom_violin</a></code> into your console (bottom-left window). How are they different than boxplots?</p>
</div>
<div id="graphing-two-categorical-variables" class="section level3" number="3.5.2">
<h3>
<span class="header-section-number">3.5.2</span> Graphing Two Categorical Variables<a class="anchor" aria-label="anchor" href="#graphing-two-categorical-variables"><i class="fas fa-link"></i></a>
</h3>
<p>The only combination of two variables that we have yet to explore are two variables that are both categorical. Let’s look at the relationship between <code>Year</code> and <code>SocialMedia</code> first using a stacked bar plot.</p>
<p>To make the graph, we specify <code>position = "fill"</code> so that the bars are “filled” by <code>stepgoal</code>.</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">stat113_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Year</span>, fill <span class="op">=</span> <span class="va">SocialMedia</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"fill"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Proportion"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="02-ggplot2_files/figure-html/unnamed-chunk-33-1.png" width="672"></div>
<p>What patterns do you notice from the plot? Is there anything about the plot that could be improved?</p>
</div>
<div id="exercise-2-3" class="section level3" number="3.5.3">
<h3>
<span class="header-section-number">3.5.3</span> Exercises<a class="anchor" aria-label="anchor" href="#exercise-2-3"><i class="fas fa-link"></i></a>
</h3>
<p>Exercises marked with an * indicate that the exercise has a solution at the end of the chapter at <a href="ggplot2.html#solutions-2">3.7</a>.</p>
<ol style="list-style-type: decimal">
<li><p>* Change the colour of the inside of the boxplots in the Exercise vs. Award graph to be <code>"blue"</code>. Do you think you’ll use <code>colour = "blue"</code> or <code>fill = "blue"</code>?</p></li>
<li><p>* Create a side-by-side boxplot that compares the <code>GPA</code>s of students who prefer different <code>Award</code>s. Then change the fill of the boxplot to be a colour of your choice. What do you notice in the plot?</p></li>
<li><p>* When making the previous plot, <code>R</code> gives us a warning message that it “Removed 70 rows containing non-finite values”. This is <code>R</code>’s robotic way of telling us that 70 <code>GPA</code> values are missing in the data set. Use what you know about how the data was collected (Fall and Spring semester of the 2018-2019 school-year) to guess why these are missing.</p></li>
<li><p>* Make a stacked bar plot for two variables of your choosing in the STAT 113 data set. Comment on something that you notice in the plot.</p></li>
</ol>
</div>
</div>
<div id="chapexercise-2" class="section level2" number="3.6">
<h2>
<span class="header-section-number">3.6</span> Chapter Exercises<a class="anchor" aria-label="anchor" href="#chapexercise-2"><i class="fas fa-link"></i></a>
</h2>
<p>Exercises marked with an * indicate that the exercise has a solution at the end of the chapter at <a href="ggplot2.html#solutions-2">3.7</a>.</p>
<ol style="list-style-type: decimal">
<li><p>* The default of <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth()</a></code> is to use LOESS (locally estimated scatterplot smoothing). Read about LOESS here: <a href="https://19january2017snapshot.epa.gov/sites/production/files/2016-07/documents/loess-lowess.pdf" target="_blank">here</a>. Write one or two sentences explaining what LOESS does.</p></li>
<li><p>* Thus far, we have only faceted by a single variable. Use Google to figure out how to facet by two variables to make a plot that shows the relationship between GPA (y-axis) and Exercise (x-axis) with four facets: one for male students who play a sport, one for female students who play a sport, one for male students who do not play a sport, and one for female students who do not play a sport.</p></li>
<li><p>* In Intro-Stat, boxplots are typically introduced using the <code>*</code> symbol to identify outliers. Using a combination of the help <code><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">?geom_boxplot</a></code> and Googling “R point shapes”, figure out how to modify your side-by-side boxplots so that the outliers are shown using <code>*</code>, not the default dots. Then, using Google, figure out how to add the mean to each boxplot as a “darkgreen” diamond-shaped symbol with <code><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary()</a></code>.</p></li>
<li><p>A common theme that we’ll see throughout the course is that it’s advantageous to know as much background information as possible about the data set we are analyzing. Data sets will be easier to analyze and pose questions about if you’re familiar with the subject matter.</p></li>
</ol>
<p>Give an example of something that you know about STAT 113 and the survey data set that helped you answer or pose a question that someone from another university (and therefore unfamiliar with our intro stat course) wouldn’t know.</p>
<p>Give an example of something that you don’t know about the fitness data set that the person who owns the fitness data would know. Why does that give an advantage to the person who is more familiar with the fitness data?</p>
</div>
<div id="solutions-2" class="section level2" number="3.7">
<h2>
<span class="header-section-number">3.7</span> Exercise Solutions<a class="anchor" aria-label="anchor" href="#solutions-2"><i class="fas fa-link"></i></a>
</h2>
<div id="introduction-etc.-s" class="section level3" number="3.7.1">
<h3>
<span class="header-section-number">3.7.1</span> Introduction etc. S<a class="anchor" aria-label="anchor" href="#introduction-etc.-s"><i class="fas fa-link"></i></a>
</h3>
</div>
<div id="basic-plot-structure-s" class="section level3" number="3.7.2">
<h3>
<span class="header-section-number">3.7.2</span> Basic Plot Structure S<a class="anchor" aria-label="anchor" href="#basic-plot-structure-s"><i class="fas fa-link"></i></a>
</h3>
</div>
<div id="graphing-a-single-variable-s" class="section level3" number="3.7.3">
<h3>
<span class="header-section-number">3.7.3</span> Graphing a Single Variable S<a class="anchor" aria-label="anchor" href="#graphing-a-single-variable-s"><i class="fas fa-link"></i></a>
</h3>
<ol start="4" style="list-style-type: decimal">
<li>* Create a histogram of the <code>Exercise</code> variable, change the x-axis label to be “Exercise (hours per typical week)”, change the number of <code>bins</code> to <code>14</code>, and change the <code>fill</code> of the bins to be “lightpink2” and the outline <code>colour</code> of the bins to be black.</li>
</ol>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">stat113_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Exercise</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">14</span>, fill <span class="op">=</span> <span class="st">"lightpink2"</span>, colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Exercise (hours per typical week)"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="02-ggplot2_files/figure-html/unnamed-chunk-34-1.png" width="672"></div>
<ol start="5" style="list-style-type: decimal">
<li>* We can change the y-axis of a histogram to be “density” instead of a raw count. This means that each bar shows a <strong>proportion</strong> of cases instead of a raw count. Google something like “geom_histogram with density” to figure out how to create a y <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> to show density instead of count.</li>
</ol>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">stat113_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Exercise</span>, y <span class="op">=</span> <span class="va">..density..</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">14</span>, fill <span class="op">=</span> <span class="st">"lightpink2"</span>, colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Exercise (hours per typical week)"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="02-ggplot2_files/figure-html/unnamed-chunk-35-1.png" width="672"></div>
</div>
<div id="graphing-two-quant.-etc.-s" class="section level3" number="3.7.4">
<h3>
<span class="header-section-number">3.7.4</span> Graphing Two Quant. etc. S<a class="anchor" aria-label="anchor" href="#graphing-two-quant.-etc.-s"><i class="fas fa-link"></i></a>
</h3>
<ol start="4" style="list-style-type: decimal">
<li>* Make a scatterplot of <code>Hgt</code> on the y-axis and <code>Wgt</code> on the x-axis, colouring by <code>Sport</code>. Add a smooth fitted curve to your scatterplot. Then, move <code>colour = Sport</code> from an <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> in the <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> function to an <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> in the <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code> function. What changes in the plot? Can you give an explanation as to why that change occurs?</li>
</ol>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">stat113_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Wgt</span>, y <span class="op">=</span> <span class="va">Hgt</span>, colour <span class="op">=</span> <span class="va">Sport</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="02-ggplot2_files/figure-html/unnamed-chunk-36-1.png" width="672"></div>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">stat113_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Wgt</span>, y <span class="op">=</span> <span class="va">Hgt</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">Sport</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="02-ggplot2_files/figure-html/unnamed-chunk-36-2.png" width="672"></div>
<p>The points are now coloured by <code>Sport</code> but there is only one smooth fitted line. This makes sense because <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code> now has the two global aesthetics x and y, as well as the colour aesthetic. <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth()</a></code> no longer has the colour aesthetic but still inherits the two global aesthetics, x and y.</p>
<ol start="5" style="list-style-type: decimal">
<li>* Faceting can be used for other types of plots too! Make a pair of faceted histograms for a quantitative variable of your choosing that are faceted by a categorical variable of your choosing.</li>
</ol>
<p>Answers will vary:</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">stat113_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">GPA</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">Sport</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="02-ggplot2_files/figure-html/unnamed-chunk-37-1.png" width="672"></div>
</div>
<div id="boxplots-stacked-etc.-s" class="section level3" number="3.7.5">
<h3>
<span class="header-section-number">3.7.5</span> Boxplots, Stacked, etc. S<a class="anchor" aria-label="anchor" href="#boxplots-stacked-etc.-s"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>* Change the colour of the inside of the boxplots in the Exercise vs. Award graph to be <code>"blue"</code>. Do you think you’ll use <code>colour = "blue"</code> or <code>fill = "blue"</code>?</li>
</ol>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">stat113_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Award</span>, y <span class="op">=</span> <span class="va">Exercise</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="02-ggplot2_files/figure-html/unnamed-chunk-38-1.png" width="672"></div>
<p><code>fill</code> because it’s the inside of the boxplots that we want to modify. <code>colour</code> will modify the outline colour.</p>
<ol start="2" style="list-style-type: decimal">
<li>* Create a side-by-side boxplot that compares the <code>GPA</code>s of students who prefer different <code>Award</code>s. Then change the fill of the boxplot to be a colour of your choice. What do you notice in the plot?</li>
</ol>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">stat113_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Award</span>, y <span class="op">=</span> <span class="va">GPA</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"lightpink1"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="02-ggplot2_files/figure-html/unnamed-chunk-39-1.png" width="672"></div>
<p>There are a few outlier students, but the three groups overall seem to have similar GPAs.</p>
<ol start="3" style="list-style-type: decimal">
<li>* When making the previous plot, <code>R</code> gives us a warning message that it “Removed 70 rows containing non-finite values”. This is <code>R</code>’s robotic way of telling us that 70 <code>GPA</code> values are missing in the data set. Use what you know about how the data was collected (Fall and Spring semeseter of the 2018-2019 school-year) to guess why these are missing.</li>
</ol>
<p>STAT 113 has first-year students: first-years taking the course in the fall would not have a GPA to report. Additionally, another reason might be that a student chose not to report his or her GPA.</p>
<ol start="4" style="list-style-type: decimal">
<li>* Make a stacked bar plot for two variables of your choosing in the STAT 113 data set. Comment on something that you notice in the plot.</li>
</ol>
<p>Answers will vary.</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">stat113_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Sport</span>, fill <span class="op">=</span> <span class="va">Award</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"fill"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="02-ggplot2_files/figure-html/unnamed-chunk-40-1.png" width="672"></div>
<p>As we might expect, it does seem like a higher proportion of students who play a sport would prefer to win an Olympic medal, compared with students who do not play a sport.</p>
</div>
<div id="chapexercise-2-S" class="section level3" number="3.7.6">
<h3>
<span class="header-section-number">3.7.6</span> Chapter Exercises S<a class="anchor" aria-label="anchor" href="#chapexercise-2-S"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>* The default of <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth()</a></code> is to use LOESS (locally estimated scatterplot smoothing). Read about LOESS here: <a href="https://19january2017snapshot.epa.gov/sites/production/files/2016-07/documents/loess-lowess.pdf" target="_blank">here</a>. Write one or two sentences explaining what LOESS does.</li>
</ol>
<p>Loess uses a bunch of local regressions to predict the y-variable at each point, giving more weight to observations near the point of interest on the x-axis. Once this is done for every point, the predictions are connected with a smooth curve.</p>
<ol start="2" style="list-style-type: decimal">
<li>* Thus far, we have only faceted by a single variable. Use Google to figure out how to facet by two variables to make a plot that shows the relationship between GPA (y-axis) and Exercise (x-axis) with four facets: one for male students who play a sport, one for female students who play a sport, one for male students who do not play a sport, and one for female students who do not play a sport.</li>
</ol>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">stat113_df</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">Sport</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">Sex</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Exercise</span>, y <span class="op">=</span> <span class="va">GPA</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">Sex</span> <span class="op">~</span> <span class="va">Sport</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using method = 'loess' and formula 'y ~ x'</span></span></code></pre></div>
<div class="inline-figure"><img src="02-ggplot2_files/figure-html/unnamed-chunk-41-1.png" width="672"></div>
<ol start="3" style="list-style-type: decimal">
<li>* In Intro-Stat, boxplots are typically introduced using the <code>*</code> symbol to identify outliers. Using a combination of the help <code><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">?geom_boxplot</a></code> and Googling “R point shapes”, figure out how to modify your side-by-side boxplots so that the outliers are shown using <code>*</code>, not the default dots.</li>
</ol>
<p>Then, using Google, figure out how to add the mean to each boxplot as a “darkgreen” diamond-shaped symbol with <code><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary()</a></code>.</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">stat113_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Sex</span>, y <span class="op">=</span> <span class="va">GPA</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"lightpink1"</span>, outlier.shape <span class="op">=</span> <span class="fl">8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, shape <span class="op">=</span> <span class="fl">18</span>, colour <span class="op">=</span> <span class="st">"darkgreen"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="02-ggplot2_files/figure-html/unnamed-chunk-42-1.png" width="672"></div>
</div>
</div>
<div id="rcode-2" class="section level2" number="3.8">
<h2>
<span class="header-section-number">3.8</span> Non-Exercise <code>R</code> Code<a class="anchor" aria-label="anchor" href="#rcode-2"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="va">pres_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_table.html">read_table</a></span><span class="op">(</span><span class="st">"data/PRES2000.txt"</span><span class="op">)</span> </span>
<span><span class="co">## don't worry about the `read_table` function....yet</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">pres_df</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pres_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Gore</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Votes for Gore in Florida"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pres_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Gore</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_freqpoly</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Votes for Gore in Florida"</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pres_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Gore</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_freqpoly</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Votes for Gore in Florida"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="op">)</span> </span>
<span><span class="va">pres_cat</span> <span class="op">&lt;-</span> <span class="va">pres_df</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>winner <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="va">Gore</span> <span class="op">&gt;</span> <span class="va">Bush</span>,</span>
<span>                                                true <span class="op">=</span> <span class="st">"Gore"</span>,</span>
<span>                                                false <span class="op">=</span> <span class="st">"Bush"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pres_cat</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pres_cat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">winner</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">pres_cat2</span> <span class="op">&lt;-</span> <span class="va">pres_cat</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">winner</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>nwins <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pres_cat2</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">pres_cat2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">winner</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">pres_cat2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">winner</span>, y <span class="op">=</span> <span class="va">nwins</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pres_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Gore</span>, y <span class="op">=</span> <span class="va">Bush</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="va">fitness_full</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"data/higham_fitness_clean.csv"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>weekend_ind <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span><span class="va">weekday</span> <span class="op">==</span> <span class="st">"Sat"</span> <span class="op">|</span> <span class="va">weekday</span> <span class="op">==</span> <span class="st">"Sun"</span> <span class="op">~</span> <span class="st">"weekend"</span>,</span>
<span>  <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"weekday"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">fitness_full</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">distance</span>, y <span class="op">=</span> <span class="va">active_cals</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">## drop observations that have active calories &lt; 50. </span></span>
<span><span class="co">## assuming that these are data errors or </span></span>
<span><span class="co">## days where the Apple Watch wasn't worn.</span></span>
<span><span class="va">fitness</span> <span class="op">&lt;-</span> <span class="va">fitness_full</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">active_cals</span> <span class="op">&gt;</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">fitness</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">distance</span>, y <span class="op">=</span> <span class="va">active_cals</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">fitness</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Start</span>, y <span class="op">=</span> <span class="va">active_cals</span>, colour <span class="op">=</span> <span class="va">weekend_ind</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">fitness</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Start</span>, y <span class="op">=</span> <span class="va">active_cals</span>, shape <span class="op">=</span> <span class="va">weekend_ind</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">fitness</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Start</span>, y <span class="op">=</span> <span class="va">active_cals</span>, size <span class="op">=</span> <span class="va">flights</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">fitness</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Start</span>, y <span class="op">=</span> <span class="va">active_cals</span>, colour <span class="op">=</span> <span class="st">"purple"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">fitness</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Start</span>, y <span class="op">=</span> <span class="va">active_cals</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">1.5</span>, shape <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">fitness</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Start</span>, y <span class="op">=</span> <span class="va">active_cals</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>span <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">fitness</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Start</span>, y <span class="op">=</span> <span class="va">active_cals</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>se <span class="op">=</span> <span class="cn">FALSE</span>, method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">fitness</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Start</span>, y <span class="op">=</span> <span class="va">steps</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Date"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">fitness</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Start</span>, y <span class="op">=</span> <span class="va">steps</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Date"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">stat113_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Exercise</span>, y <span class="op">=</span> <span class="va">Pulse</span>,</span>
<span>                           colour <span class="op">=</span> <span class="va">Year</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>se <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">stat113_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Exercise</span>, y <span class="op">=</span> <span class="va">Pulse</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>se <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">Year</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">stat113_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Award</span>, y <span class="op">=</span> <span class="va">Exercise</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">stat113_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Award</span>, y <span class="op">=</span> <span class="va">Exercise</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">stat113_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Year</span>, fill <span class="op">=</span> <span class="va">SocialMedia</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"fill"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Proportion"</span><span class="op">)</span></span></code></pre></div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="intro.html"><span class="header-section-number">2</span> Getting Started with R and R Studio</a></div>
<div class="next"><a href="dplyr.html"><span class="header-section-number">4</span> Wrangling with dplyr</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#ggplot2"><span class="header-section-number">3</span> Plotting with ggplot2</a></li>
<li><a class="nav-link" href="#introduction-and-basic-terminology"><span class="header-section-number">3.1</span> Introduction and Basic Terminology</a></li>
<li><a class="nav-link" href="#basic-plot-structure"><span class="header-section-number">3.2</span> Basic Plot Structure</a></li>
<li>
<a class="nav-link" href="#graphing-a-single-variable"><span class="header-section-number">3.3</span> Graphing a Single Variable</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#histograms-and-frequency-plots-for-a-quantitative-variable"><span class="header-section-number">3.3.1</span> Histograms and Frequency Plots for a Quantitative Variable</a></li>
<li><a class="nav-link" href="#r-code-style"><span class="header-section-number">3.3.2</span> R Code Style</a></li>
<li><a class="nav-link" href="#bar-plots-for-a-categorical-variable"><span class="header-section-number">3.3.3</span> Bar Plots for a Categorical Variable</a></li>
<li><a class="nav-link" href="#exercise-2-1"><span class="header-section-number">3.3.4</span> Exercises</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#graphing-two-quantitative-variables-faceting-and-aes-options"><span class="header-section-number">3.4</span> Graphing Two Quantitative Variables, Faceting, and aes() Options</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#scatterplots"><span class="header-section-number">3.4.1</span> Scatterplots</a></li>
<li><a class="nav-link" href="#aesthetics-in-aes"><span class="header-section-number">3.4.2</span> Aesthetics in aes()</a></li>
<li><a class="nav-link" href="#using-more-than-one-geom"><span class="header-section-number">3.4.3</span> Using More Than One geom()</a></li>
<li><a class="nav-link" href="#line-plots-with-geom_line"><span class="header-section-number">3.4.4</span> Line Plots with geom_line()</a></li>
<li><a class="nav-link" href="#faceting"><span class="header-section-number">3.4.5</span> Faceting</a></li>
<li><a class="nav-link" href="#exercise-2-2"><span class="header-section-number">3.4.6</span> Exercises</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#boxplots-stacked-barplots-and-others"><span class="header-section-number">3.5</span> Boxplots, Stacked Barplots and Others</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#graphing-a-quant.-variable-vs.-a-cat.-variable"><span class="header-section-number">3.5.1</span> Graphing a Quant. Variable vs. a Cat. Variable</a></li>
<li><a class="nav-link" href="#graphing-two-categorical-variables"><span class="header-section-number">3.5.2</span> Graphing Two Categorical Variables</a></li>
<li><a class="nav-link" href="#exercise-2-3"><span class="header-section-number">3.5.3</span> Exercises</a></li>
</ul>
</li>
<li><a class="nav-link" href="#chapexercise-2"><span class="header-section-number">3.6</span> Chapter Exercises</a></li>
<li>
<a class="nav-link" href="#solutions-2"><span class="header-section-number">3.7</span> Exercise Solutions</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#introduction-etc.-s"><span class="header-section-number">3.7.1</span> Introduction etc. S</a></li>
<li><a class="nav-link" href="#basic-plot-structure-s"><span class="header-section-number">3.7.2</span> Basic Plot Structure S</a></li>
<li><a class="nav-link" href="#graphing-a-single-variable-s"><span class="header-section-number">3.7.3</span> Graphing a Single Variable S</a></li>
<li><a class="nav-link" href="#graphing-two-quant.-etc.-s"><span class="header-section-number">3.7.4</span> Graphing Two Quant. etc. S</a></li>
<li><a class="nav-link" href="#boxplots-stacked-etc.-s"><span class="header-section-number">3.7.5</span> Boxplots, Stacked, etc. S</a></li>
<li><a class="nav-link" href="#chapexercise-2-S"><span class="header-section-number">3.7.6</span> Chapter Exercises S</a></li>
</ul>
</li>
<li><a class="nav-link" href="#rcode-2"><span class="header-section-number">3.8</span> Non-Exercise R Code</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>STAT 234: Data Science</strong>" was written by Matt Higham. It was last built on 2022-09-14.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
