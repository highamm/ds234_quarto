<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>DATA / STAT 234 - 12&nbsp; Dates with lubridate</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./12-stringr.html" rel="next">
<link href="./10-merging.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./11-lubridate.html">Special Topics</a></li><li class="breadcrumb-item"><a href="./11-lubridate.html"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Dates with `lubridate`</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">DATA / STAT 234</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Syllabus and Course Information</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">The Core</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Getting Started</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-ggplot2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Plotting with <code>ggplot2</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Wrangling with <code>dplyr</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-comm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Communication with <code>Quarto</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Workflow and Other Skills</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Data Wrangling</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-tidyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Tidying with <code>tidyr</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Coding in Base <code>R</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-forcats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Factors with <code>forcats</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-ethics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Data Ethics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Data Import</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-merging.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Merging with <code>dplyr</code></span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Special Topics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-lubridate.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Dates with <code>lubridate</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-stringr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Text Data with <code>tidytext</code> and <code>stringr</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-knn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Predictive Modeling with knn</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-connections.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Connections to STAT 113, STAT 213, and CS 140</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-sql.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Introduction to SQL with <code>dbplyr</code></span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#converting-variables-to-date" id="toc-converting-variables-to-date" class="nav-link active" data-scroll-target="#converting-variables-to-date"><span class="header-section-number">12.1</span> Converting Variables to <code>&lt;date&gt;</code></a>
  <ul class="collapse">
<li><a href="#from-chr-to-date" id="toc-from-chr-to-date" class="nav-link" data-scroll-target="#from-chr-to-date"><span class="header-section-number">12.1.1</span> From <code>&lt;chr&gt;</code> to <code>&lt;date&gt;</code></a></li>
  <li><a href="#making-a-date-variable-from-date-components" id="toc-making-a-date-variable-from-date-components" class="nav-link" data-scroll-target="#making-a-date-variable-from-date-components"><span class="header-section-number">12.1.2</span> Making a <code>&lt;date&gt;</code> variable from Date Components</a></li>
  </ul>
</li>
  <li>
<a href="#functions-for-date-variables" id="toc-functions-for-date-variables" class="nav-link" data-scroll-target="#functions-for-date-variables"><span class="header-section-number">12.2</span> Functions for <code>&lt;date&gt;</code> Variables</a>
  <ul class="collapse">
<li><a href="#year-month-and-mday" id="toc-year-month-and-mday" class="nav-link" data-scroll-target="#year-month-and-mday"><span class="header-section-number">12.2.1</span> <code>year()</code>, <code>month()</code>, and <code>mday()</code></a></li>
  <li><a href="#yday-and-wday" id="toc-yday-and-wday" class="nav-link" data-scroll-target="#yday-and-wday"><span class="header-section-number">12.2.2</span> <code>yday()</code> and <code>wday()</code></a></li>
  </ul>
</li>
  <li>
<a href="#practice" id="toc-practice" class="nav-link" data-scroll-target="#practice"><span class="header-section-number">12.3</span> Practice</a>
  <ul class="collapse">
<li><a href="#class-exercises" id="toc-class-exercises" class="nav-link" data-scroll-target="#class-exercises"><span class="header-section-number">12.3.1</span> Class Exercises</a></li>
  <li><a href="#your-turn" id="toc-your-turn" class="nav-link" data-scroll-target="#your-turn"><span class="header-section-number">12.3.2</span> Your Turn</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="lubridate" class="quarto-section-identifier"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Dates with <code>lubridate</code></span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p><strong>Goals</strong>:</p>
<ul>
<li>use <code>lubridate</code> functions to convert a character variable to a <code>&lt;date&gt;</code> variable.</li>
<li>use <code>lubridate</code> functions to extract useful information from a <code>&lt;date&gt;</code> variable, including the year, month, day of the week, and day of the year.</li>
</ul>
<section id="converting-variables-to-date" class="level2" data-number="12.1"><h2 data-number="12.1" class="anchored" data-anchor-id="converting-variables-to-date">
<span class="header-section-number">12.1</span> Converting Variables to <code>&lt;date&gt;</code>
</h2>
<p>The <code>lubridate</code> package is built to easily work with <code>Date</code> objects and <code>DateTime</code> objects. <code>R</code> does not actually have a class that stores <code>Time</code> objects (unless you install a separate package). Dates tend to be much more common than Times, so, we will primarily focus on Dates, but most functions we will see have easy extensions to Times.</p>
<p>To begin, install the <code>lubridate</code> package, and load the package with <code><a href="https://rdrr.io/r/base/library.html">library()</a></code>. The <code><a href="https://lubridate.tidyverse.org/reference/now.html">today()</a></code> function prints today’s date while <code><a href="https://lubridate.tidyverse.org/reference/now.html">now()</a></code> prints today’s date and time. These can sometimes be useful in other contexts, but we will just run the code to see how <code>R</code> stores dates and date-times.</p>
<div class="cell" data-appendix="true">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org">lubridate</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/now.html">today</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "2024-01-26"</span></span>
<span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/now.html">now</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "2024-01-26 15:59:04 EST"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This first section will deal with how to convert a variable in <code>R</code> to be a <code>Date</code>. We will use a data set that has the holidays of Animal Crossing from January to April. The columns in this data set are:</p>
<ul>
<li>
<code>Holiday</code>, the name of the holiday and</li>
<li>various other columns with different date formats</li>
</ul>
<p>Read in the data set with</p>
<div class="cell" data-appendix="true">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/">here</a></span><span class="op">)</span></span>
<span><span class="va">holiday_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data/animal_crossing_holidays.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">holiday_df</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 10</span></span>
<span><span class="co">#&gt;   Holiday         Date1     Date2  Date3 Date4 Date5 Month  Year   Day Month2</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;           &lt;chr&gt;     &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; </span></span>
<span><span class="co">#&gt; 1 New Year's Day  1-Jan-20  Jan-1… 1/1/… 1/1/… 2020…     1  2020     1 Janua…</span></span>
<span><span class="co">#&gt; 2 Groundhog Day   2-Feb-20  Feb-2… 2/2/… 2/2/… 2020…     2  2020     2 Febru…</span></span>
<span><span class="co">#&gt; 3 Valentine's Day 14-Feb-20 Feb-1… 2/14… 2020… 2020…     2  2020    14 Febru…</span></span>
<span><span class="co">#&gt; 4 Shamrock Day    17-Mar-20 Mar-1… 3/17… 2020… 2020…     3  2020    17 March </span></span>
<span><span class="co">#&gt; 5 Bunny Day       12-Apr-20 Apr-1… 4/12… 12/4… 2020…     4  2020    12 April </span></span>
<span><span class="co">#&gt; 6 Earth Day       22-Apr-20 Apr-2… 4/22… 2020… 2020…     4  2020    22 April</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Which columns were specified as Dates? In this example, none of the columns have the <code>&lt;date&gt;</code> specification: all of the date columns are read in as character variables.</p>
<section id="from-chr-to-date" class="level3" data-number="12.1.1"><h3 data-number="12.1.1" class="anchored" data-anchor-id="from-chr-to-date">
<span class="header-section-number">12.1.1</span> From <code>&lt;chr&gt;</code> to <code>&lt;date&gt;</code>
</h3>
<p>We will use the <code><a href="https://lubridate.tidyverse.org/reference/ymd.html">dmy()</a></code> series of functions in <code>lubridate</code> to convert character variables to dates.</p>
<p>There are a series of <code><a href="https://lubridate.tidyverse.org/reference/ymd.html">dmy()</a></code>-type variables, each corresponding to a different Day-Month-Year order.</p>
<ul>
<li>
<code><a href="https://lubridate.tidyverse.org/reference/ymd.html">dmy()</a></code> is used to parse a date from a character vector that has the day first, month second, and year last.</li>
<li>
<code><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd()</a></code> is used to parse a date that has year first, month second, and date last</li>
<li>
<code><a href="https://lubridate.tidyverse.org/reference/ymd.html">ydm()</a></code> is used to parse a date that has year first, day second, and month last,….</li>
</ul>
<p>and <code><a href="https://lubridate.tidyverse.org/reference/ymd.html">dym()</a></code>, <code><a href="https://lubridate.tidyverse.org/reference/ymd.html">mdy()</a></code>, and <code><a href="https://lubridate.tidyverse.org/reference/ymd.html">myd()</a></code> work similarly. <code>lubridate</code> is usually “smart” and picks up dates in all kinds of different formats (e.g.&nbsp;it can pick up specifying <code>October</code> as the month and <code>Oct</code> as the month and <code>10</code> as the month).</p>
<div class="callout callout-style-simple callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>We will typically pair these <code>lubridate</code> functions with a <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> statement: much like the <code>forcats</code> functions, we are almost always <strong>creating</strong> a new variable.</p>
</div>
</div>
<p>Let’s try it out on <code>Date1</code> and <code>Date2</code>:</p>
<div class="cell" data-appendix="true">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">holiday_df</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Date_test <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">dmy</a></span><span class="op">(</span><span class="va">Date1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Date_test</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 11</span></span>
<span><span class="co">#&gt;   Date_test  Holiday   Date1 Date2 Date3 Date4 Date5 Month  Year   Day Month2</span></span>
<span><span class="co">#&gt;   &lt;date&gt;     &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; </span></span>
<span><span class="co">#&gt; 1 2020-01-01 New Year… 1-Ja… Jan-… 1/1/… 1/1/… 2020…     1  2020     1 Janua…</span></span>
<span><span class="co">#&gt; 2 2020-02-02 Groundho… 2-Fe… Feb-… 2/2/… 2/2/… 2020…     2  2020     2 Febru…</span></span>
<span><span class="co">#&gt; 3 2020-02-14 Valentin… 14-F… Feb-… 2/14… 2020… 2020…     2  2020    14 Febru…</span></span>
<span><span class="co">#&gt; 4 2020-03-17 Shamrock… 17-M… Mar-… 3/17… 2020… 2020…     3  2020    17 March </span></span>
<span><span class="co">#&gt; 5 2020-04-12 Bunny Day 12-A… Apr-… 4/12… 12/4… 2020…     4  2020    12 April </span></span>
<span><span class="co">#&gt; 6 2020-04-22 Earth Day 22-A… Apr-… 4/22… 2020… 2020…     4  2020    22 April</span></span>
<span><span class="va">holiday_df</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Date_test <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">mdy</a></span><span class="op">(</span><span class="va">Date2</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Date_test</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 11</span></span>
<span><span class="co">#&gt;   Date_test  Holiday   Date1 Date2 Date3 Date4 Date5 Month  Year   Day Month2</span></span>
<span><span class="co">#&gt;   &lt;date&gt;     &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; </span></span>
<span><span class="co">#&gt; 1 2020-01-01 New Year… 1-Ja… Jan-… 1/1/… 1/1/… 2020…     1  2020     1 Janua…</span></span>
<span><span class="co">#&gt; 2 2020-02-02 Groundho… 2-Fe… Feb-… 2/2/… 2/2/… 2020…     2  2020     2 Febru…</span></span>
<span><span class="co">#&gt; 3 2020-02-14 Valentin… 14-F… Feb-… 2/14… 2020… 2020…     2  2020    14 Febru…</span></span>
<span><span class="co">#&gt; 4 2020-03-17 Shamrock… 17-M… Mar-… 3/17… 2020… 2020…     3  2020    17 March </span></span>
<span><span class="co">#&gt; 5 2020-04-12 Bunny Day 12-A… Apr-… 4/12… 12/4… 2020…     4  2020    12 April </span></span>
<span><span class="co">#&gt; 6 2020-04-22 Earth Day 22-A… Apr-… 4/22… 2020… 2020…     4  2020    22 April</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>A Reminder</strong>: Why do <code>&lt;date&gt;</code> objects even matter? Compare the following two plots: one made where the date is in <code>&lt;chr&gt;</code> form and the other where date is in its appropriate <code>&lt;date&gt;</code> form.</p>
<div class="cell" data-appendix="true">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">holiday_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Date1</span>, y <span class="op">=</span> <span class="va">Holiday</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="11-lubridate_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="va">holiday_df</span> <span class="op">&lt;-</span> <span class="va">holiday_df</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Date_test_plot <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">dmy</a></span><span class="op">(</span><span class="va">Date1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Date_test_plot</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">holiday_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Date_test_plot</span>, y <span class="op">=</span> <span class="va">Holiday</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="11-lubridate_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In which plot does the ordering on the x-axis make more sense?</p>
</section><section id="making-a-date-variable-from-date-components" class="level3" data-number="12.1.2"><h3 data-number="12.1.2" class="anchored" data-anchor-id="making-a-date-variable-from-date-components">
<span class="header-section-number">12.1.2</span> Making a <code>&lt;date&gt;</code> variable from Date Components</h3>
<p>Another way to create a Date object is to assemble it with <code><a href="https://lubridate.tidyverse.org/reference/make_datetime.html">make_date()</a></code> from a month, day, and year components, each stored in a separate column:</p>
<div class="cell" data-appendix="true">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">holiday_df</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Date_test2 <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/make_datetime.html">make_date</a></span><span class="op">(</span>year <span class="op">=</span> <span class="va">Year</span>,</span>
<span>                                             month <span class="op">=</span> <span class="va">Month</span>,</span>
<span>                                             day <span class="op">=</span> <span class="va">Day</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Date_test2</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 12</span></span>
<span><span class="co">#&gt;   Date_test2 Date_test_plot Holiday Date1 Date2 Date3 Date4 Date5 Month  Year</span></span>
<span><span class="co">#&gt;   &lt;date&gt;     &lt;date&gt;         &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 2020-01-01 2020-01-01     New Ye… 1-Ja… Jan-… 1/1/… 1/1/… 2020…     1  2020</span></span>
<span><span class="co">#&gt; 2 2020-02-02 2020-02-02     Ground… 2-Fe… Feb-… 2/2/… 2/2/… 2020…     2  2020</span></span>
<span><span class="co">#&gt; 3 2020-02-14 2020-02-14     Valent… 14-F… Feb-… 2/14… 2020… 2020…     2  2020</span></span>
<span><span class="co">#&gt; 4 2020-03-17 2020-03-17     Shamro… 17-M… Mar-… 3/17… 2020… 2020…     3  2020</span></span>
<span><span class="co">#&gt; 5 2020-04-12 2020-04-12     Bunny … 12-A… Apr-… 4/12… 12/4… 2020…     4  2020</span></span>
<span><span class="co">#&gt; 6 2020-04-22 2020-04-22     Earth … 22-A… Apr-… 4/22… 2020… 2020…     4  2020</span></span>
<span><span class="co">#&gt; # ℹ 2 more variables: Day &lt;dbl&gt;, Month2 &lt;chr&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>But, when <code>Month</code> is stored as a character (e.g.&nbsp;<code>February</code>) instead of a number (e.g.&nbsp;<code>2</code>), problems arise with the <code><a href="https://lubridate.tidyverse.org/reference/make_datetime.html">make_date()</a></code> function:</p>
<div class="cell" data-appendix="true">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">holiday_df</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Date_test2 <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/make_datetime.html">make_date</a></span><span class="op">(</span>year <span class="op">=</span> <span class="va">Year</span>,</span>
<span>                                             month <span class="op">=</span> <span class="va">Month2</span>,</span>
<span>                                             day <span class="op">=</span> <span class="va">Day</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Date_test2</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 12</span></span>
<span><span class="co">#&gt;   Date_test2 Date_test_plot Holiday Date1 Date2 Date3 Date4 Date5 Month  Year</span></span>
<span><span class="co">#&gt;   &lt;date&gt;     &lt;date&gt;         &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 NA         2020-01-01     New Ye… 1-Ja… Jan-… 1/1/… 1/1/… 2020…     1  2020</span></span>
<span><span class="co">#&gt; 2 NA         2020-02-02     Ground… 2-Fe… Feb-… 2/2/… 2/2/… 2020…     2  2020</span></span>
<span><span class="co">#&gt; 3 NA         2020-02-14     Valent… 14-F… Feb-… 2/14… 2020… 2020…     2  2020</span></span>
<span><span class="co">#&gt; 4 NA         2020-03-17     Shamro… 17-M… Mar-… 3/17… 2020… 2020…     3  2020</span></span>
<span><span class="co">#&gt; 5 NA         2020-04-12     Bunny … 12-A… Apr-… 4/12… 12/4… 2020…     4  2020</span></span>
<span><span class="co">#&gt; 6 NA         2020-04-22     Earth … 22-A… Apr-… 4/22… 2020… 2020…     4  2020</span></span>
<span><span class="co">#&gt; # ℹ 2 more variables: Day &lt;dbl&gt;, Month2 &lt;chr&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>So the <code><a href="https://lubridate.tidyverse.org/reference/make_datetime.html">make_date()</a></code> function requires a specific format for the year, month, and day columns. It may take a little pre-processing to put a particular data set in that format.</p>
<p><strong>Exercise 1</strong>. What’s the issue with trying to convert <code>Date4</code> to a <code>&lt;date&gt;</code> form? You may want to investigate <code>Date4</code> further to answer this question.</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">holiday_df</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Date_test <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="va">Date4</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Date_test</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 12</span></span>
<span><span class="co">#&gt;   Date_test  Date_test_plot Holiday Date1 Date2 Date3 Date4 Date5 Month  Year</span></span>
<span><span class="co">#&gt;   &lt;date&gt;     &lt;date&gt;         &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 2001-01-20 2020-01-01     New Ye… 1-Ja… Jan-… 1/1/… 1/1/… 2020…     1  2020</span></span>
<span><span class="co">#&gt; 2 2002-02-20 2020-02-02     Ground… 2-Fe… Feb-… 2/2/… 2/2/… 2020…     2  2020</span></span>
<span><span class="co">#&gt; 3 NA         2020-02-14     Valent… 14-F… Feb-… 2/14… 2020… 2020…     2  2020</span></span>
<span><span class="co">#&gt; 4 NA         2020-03-17     Shamro… 17-M… Mar-… 3/17… 2020… 2020…     3  2020</span></span>
<span><span class="co">#&gt; 5 2012-04-20 2020-04-12     Bunny … 12-A… Apr-… 4/12… 12/4… 2020…     4  2020</span></span>
<span><span class="co">#&gt; 6 NA         2020-04-22     Earth … 22-A… Apr-… 4/22… 2020… 2020…     4  2020</span></span>
<span><span class="co">#&gt; # ℹ 2 more variables: Day &lt;dbl&gt;, Month2 &lt;chr&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Exercise 2</strong>. Practice converting <code>Date3</code> and <code>Date5</code> to <code>&lt;date&gt;</code> variables with <code>lubridate</code> functions.</p>
</section></section><section id="functions-for-date-variables" class="level2" data-number="12.2"><h2 data-number="12.2" class="anchored" data-anchor-id="functions-for-date-variables">
<span class="header-section-number">12.2</span> Functions for <code>&lt;date&gt;</code> Variables</h2>
<p>Once an object is in the <code>&lt;date&gt;</code> format, there are some special functions in <code>lubridate</code> that can be used on that date variable. To investigate some of these functions, we will pull stock market data from Yahoo using the <code>quantmod</code> package. Install the package, and run the following code, which gets stock market price data on Apple, Nintendo, Chipotle, and the S &amp; P 500 Index from 2011 to now.</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>We have the ability to understand all of the code below, but we will skip over this code for now to focus more on the new information in this section (information about date functions).</p>
</div>
</div>
<div class="cell" data-appendix="true">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## install.packages("quantmod")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.quantmod.com">quantmod</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="st">"2011-01-01"</span><span class="op">)</span></span>
<span><span class="va">end</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="st">"2021-5-19"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/quantmod/man/getSymbols.html">getSymbols</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AAPL"</span>, <span class="st">"NTDOY"</span>, <span class="st">"CMG"</span>, <span class="st">"SPY"</span><span class="op">)</span>, src <span class="op">=</span> <span class="st">"yahoo"</span>,</span>
<span>           from <span class="op">=</span> <span class="va">start</span>, to <span class="op">=</span> <span class="va">end</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "AAPL"  "NTDOY" "CMG"   "SPY"</span></span>
<span></span>
<span><span class="va">date_tib</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/zoo/man/index.html">index</a></span><span class="op">(</span><span class="va">AAPL</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>start_date <span class="op">=</span> <span class="va">value</span><span class="op">)</span></span>
<span><span class="va">app_tib</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="va">AAPL</span><span class="op">)</span></span>
<span><span class="va">nint_tib</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="va">NTDOY</span><span class="op">)</span></span>
<span><span class="va">chip_tib</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="va">CMG</span><span class="op">)</span></span>
<span><span class="va">spy_tib</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="va">SPY</span><span class="op">)</span></span>
<span><span class="va">all_stocks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html">bind_cols</a></span><span class="op">(</span><span class="va">date_tib</span>, <span class="va">app_tib</span>, <span class="va">nint_tib</span>, <span class="va">chip_tib</span>, <span class="va">spy_tib</span><span class="op">)</span></span>
<span></span>
<span><span class="va">stocks_long</span> <span class="op">&lt;-</span> <span class="va">all_stocks</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">start_date</span>, <span class="va">AAPL.Adjusted</span>, <span class="va">NTDOY.Adjusted</span>,</span>
<span>                      <span class="va">CMG.Adjusted</span>, <span class="va">SPY.Adjusted</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">5</span>, names_to <span class="op">=</span> <span class="st">"Stock_Type"</span>, values_to <span class="op">=</span> <span class="st">"Price"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Stock_Type <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_recode.html">fct_recode</a></span><span class="op">(</span><span class="va">Stock_Type</span>,</span>
<span>                                 Apple <span class="op">=</span> <span class="st">"AAPL.Adjusted"</span>,</span>
<span>                                 Nintendo <span class="op">=</span> <span class="st">"NTDOY.Adjusted"</span>,</span>
<span>                                 Chipotle <span class="op">=</span> <span class="st">"CMG.Adjusted"</span>,</span>
<span>                                 `S &amp; P 500` <span class="op">=</span> <span class="st">"SPY.Adjusted"</span></span>
<span>                                 <span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="va">stocks_long</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 3</span></span>
<span><span class="co">#&gt;   start_date Stock_Type  Price</span></span>
<span><span class="co">#&gt;   &lt;date&gt;     &lt;fct&gt;       &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 2021-05-17 Chipotle   1332. </span></span>
<span><span class="co">#&gt; 2 2021-05-17 S &amp; P 500   399. </span></span>
<span><span class="co">#&gt; 3 2021-05-18 Apple       123. </span></span>
<span><span class="co">#&gt; 4 2021-05-18 Nintendo     14.1</span></span>
<span><span class="co">#&gt; 5 2021-05-18 Chipotle   1325. </span></span>
<span><span class="co">#&gt; 6 2021-05-18 S &amp; P 500   395.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You’ll have a chance in class to choose your own stocks to investigate. For now, we’ve made a data set with three variables:</p>
<ul>
<li>
<code>start_date</code>, the opening date for the stock market</li>
<li>
<code>Stock_Type</code>, a factor with 4 levels: <code>Apple</code>, <code>Nintendo</code>, <code>Chipotle</code>, and <code>S &amp; P 500</code>
</li>
<li>
<code>Price</code>, the price of the stock?</li>
</ul>
<p>First, let’s make a line plot that shows how the S &amp; P 500 has changed over time:</p>
<div class="cell" data-appendix="true">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">stocks_sp</span> <span class="op">&lt;-</span> <span class="va">stocks_long</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Stock_Type</span> <span class="op">==</span> <span class="st">"S &amp; P 500"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">stocks_sp</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">start_date</span>, y <span class="op">=</span> <span class="va">Price</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="11-lubridate_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>But, there’s other information that we can get from the <code>start_date</code> variable. We might be interested in things like day of the week, monthly trends, or yearly trends. To extract variables like “weekday” and “month” from a <code>&lt;date&gt;</code> variable, there are a series of functions that are fairly straightforward to use. We will discuss the <code><a href="https://lubridate.tidyverse.org/reference/year.html">year()</a></code> <code><a href="https://lubridate.tidyverse.org/reference/month.html">month()</a></code>, <code><a href="https://lubridate.tidyverse.org/reference/day.html">mday()</a></code>, <code><a href="https://lubridate.tidyverse.org/reference/day.html">yday()</a></code>, and <code><a href="https://lubridate.tidyverse.org/reference/day.html">wday()</a></code> functions.</p>
<section id="year-month-and-mday" class="level3" data-number="12.2.1"><h3 data-number="12.2.1" class="anchored" data-anchor-id="year-month-and-mday">
<span class="header-section-number">12.2.1</span> <code>year()</code>, <code>month()</code>, and <code>mday()</code>
</h3>
<p>The functions <code><a href="https://lubridate.tidyverse.org/reference/year.html">year()</a></code>, <code><a href="https://lubridate.tidyverse.org/reference/month.html">month()</a></code>, and <code><a href="https://lubridate.tidyverse.org/reference/day.html">mday()</a></code> can grab the year, month, and day of the month, respectively, from a <code>&lt;date&gt;</code> variable.</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Like the <code>forcats</code> functions and the earlier <code>lubridate</code> functions, the <code><a href="https://lubridate.tidyverse.org/reference/year.html">year()</a></code>, <code><a href="https://lubridate.tidyverse.org/reference/month.html">month()</a></code>, and <code><a href="https://lubridate.tidyverse.org/reference/day.html">mday()</a></code> functions will almost always be paired with a <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> statement because they will create a new variable.</p>
</div>
</div>
<div class="cell" data-appendix="true">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">stocks_long</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>year_stock <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/year.html">year</a></span><span class="op">(</span><span class="va">start_date</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">stocks_long</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>month_stock <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/month.html">month</a></span><span class="op">(</span><span class="va">start_date</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">stocks_long</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>day_stock <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/day.html">mday</a></span><span class="op">(</span><span class="va">start_date</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="yday-and-wday" class="level3" data-number="12.2.2"><h3 data-number="12.2.2" class="anchored" data-anchor-id="yday-and-wday">
<span class="header-section-number">12.2.2</span> <code>yday()</code> and <code>wday()</code>
</h3>
<p>The <code><a href="https://lubridate.tidyverse.org/reference/day.html">yday()</a></code> function grabs the day of the year from a <code>&lt;date&gt;</code> object. For example,</p>
<div class="cell" data-appendix="true">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">mdy</a></span><span class="op">(</span><span class="st">"November 4, 2020"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/day.html">yday</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 309</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>returns <code>309</code>, indicating that November 4th is the 309th day of the year 2020. Using this function in a <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> statement creates a new variable that has <code>yday</code> for each observation:</p>
<div class="cell" data-appendix="true">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">stocks_long</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>day_in_year <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/day.html">yday</a></span><span class="op">(</span><span class="va">start_date</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 10,444 × 4</span></span>
<span><span class="co">#&gt;   start_date Stock_Type  Price day_in_year</span></span>
<span><span class="co">#&gt;   &lt;date&gt;     &lt;fct&gt;       &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 2011-01-03 Apple        9.98           3</span></span>
<span><span class="co">#&gt; 2 2011-01-03 Nintendo     7.34           3</span></span>
<span><span class="co">#&gt; 3 2011-01-03 Chipotle   224.             3</span></span>
<span><span class="co">#&gt; 4 2011-01-03 S &amp; P 500   99.6            3</span></span>
<span><span class="co">#&gt; 5 2011-01-04 Apple       10.0            4</span></span>
<span><span class="co">#&gt; 6 2011-01-04 Nintendo     7.1            4</span></span>
<span><span class="co">#&gt; # ℹ 10,438 more rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finally, the function <code><a href="https://lubridate.tidyverse.org/reference/day.html">wday()</a></code> grabs the day of the week from a <code>&lt;date&gt;</code>. By default, <code><a href="https://lubridate.tidyverse.org/reference/day.html">wday()</a></code> puts the day of the week as a numeric, but I find this confusing, as I can’t ever remember whether a <code>1</code> means <code>Sunday</code> or a <code>1</code> means <code>Monday</code>. Adding, <code>label = TRUE</code> creates the weekday variable as <code>Sunday</code>, <code>Monday</code>, <code>Tuesday</code>, etc.:</p>
<div class="cell" data-appendix="true">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">stocks_long</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>day_of_week <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/day.html">wday</a></span><span class="op">(</span><span class="va">start_date</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">stocks_long</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>day_of_week <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/day.html">wday</a></span><span class="op">(</span><span class="va">start_date</span>,</span>
<span>                                          label <span class="op">=</span> <span class="cn">TRUE</span>, abbr <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Possible uses for these functions are:</p>
<ul>
<li><p>we want to look at differences between years (with <code><a href="https://lubridate.tidyverse.org/reference/year.html">year()</a></code>)</p></li>
<li><p>we want to look at differences between months (with <code><a href="https://lubridate.tidyverse.org/reference/month.html">month()</a></code>)</p></li>
<li><p>we want to look at differences between days of the week (with <code><a href="https://lubridate.tidyverse.org/reference/day.html">wday()</a></code>)</p></li>
<li><p>we want to see whether there are yearly trends <strong>within years</strong> (with <code><a href="https://lubridate.tidyverse.org/reference/day.html">yday()</a></code>)</p></li>
</ul>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Working with times is extremely similar to working with dates. Instead of <code><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd()</a></code>, <code><a href="https://lubridate.tidyverse.org/reference/ymd.html">mdy()</a></code>, etc., you tack on a few extra letters to specify the order that the hour, minute, and seconds appear in the variable: <code><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html">ymd_hms()</a></code> converts a character vector that has the order year, month, day, hour, minute, second to a <code>&lt;datetime&gt;</code>.</p>
<p>Additionally, the functions <code><a href="https://lubridate.tidyverse.org/reference/hour.html">hour()</a></code>, <code><a href="https://lubridate.tidyverse.org/reference/minute.html">minute()</a></code>, and <code><a href="https://lubridate.tidyverse.org/reference/second.html">second()</a></code> grab the hour, minute, and second from a <code>&lt;datetime&gt;</code> variable.</p>
</div>
</div>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Things can get complicated with dates and times, especially if you start to consider things like time <strong>duration</strong>. Consider how the following might affect an analysis involving time duration:</p>
<ul>
<li>time zones</li>
<li>leap years (not all years have the same number of days)</li>
<li>differing number of days in a given month</li>
<li>daylight saving time (not all days have the same number of hours)</li>
</ul>
</div>
</div>
<p><strong>Exercise 3</strong>. The <code><a href="https://lubridate.tidyverse.org/reference/month.html">month()</a></code> function gives the numbers corresponding to each month by default. Type <code><a href="https://lubridate.tidyverse.org/reference/month.html">?month</a></code> and figure out which argument you would need to change to get the <strong>names</strong> (January, February, etc.) instead of the month numbers. What about the <strong>abbreviations</strong> (Jan, Feb, etc.) of each month instead of the month numbers? Try making the changes in the <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> statement below.</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">stocks_long</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>month_stock <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/month.html">month</a></span><span class="op">(</span><span class="va">start_date</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="practice" class="level2" data-number="12.3"><h2 data-number="12.3" class="anchored" data-anchor-id="practice">
<span class="header-section-number">12.3</span> Practice</h2>
<section id="class-exercises" class="level3" data-number="12.3.1"><h3 data-number="12.3.1" class="anchored" data-anchor-id="class-exercises">
<span class="header-section-number">12.3.1</span> Class Exercises</h3>
<p><strong>Class Exercise 1</strong>. The <code>truncated</code> argument to <code><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd()</a></code>, <code><a href="https://lubridate.tidyverse.org/reference/ymd.html">dmy()</a></code>, <code><a href="https://lubridate.tidyverse.org/reference/ymd.html">mdy()</a></code>, etc. will allow <code>R</code> to parse dates that aren’t actually complete. For example,</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org">lubridate</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="st">"2019"</span>, truncated <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "2019-01-01"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>parses <code>2019</code> to be January 1, 2019 when the month and day are missing. The <code>2</code> means that the last two parts of the date (in this case, month and day) are allowed to be missing. Similarly,</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">dmy</a></span><span class="op">(</span><span class="st">"19-10"</span>, truncated <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "0000-10-19"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>truncates the year (which is given as <code>0000</code>). The truncate function is usually most useful in the context of the first example with a truncated month and/or day.</p>
<p>Examine the <code>ds_google.csv</code>, which contains</p>
<ul>
<li>
<code>Month</code>, the year and month from 2004 to now</li>
<li>
<code>Data_Science</code>, the relative popularity of data science (Google keeps how it calculates “popularity” as somewhat of a mystery but it is likely based off of the number of times people search for the term “Data Science”)</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org">lubridate</a></span><span class="op">)</span></span>
<span><span class="va">ds_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data/ds_google.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ds_df</span></span>
<span><span class="co">#&gt; # A tibble: 202 × 2</span></span>
<span><span class="co">#&gt;   Month   Data_Science</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;          &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 2004-01           14</span></span>
<span><span class="co">#&gt; 2 2004-02            8</span></span>
<span><span class="co">#&gt; 3 2004-03           16</span></span>
<span><span class="co">#&gt; 4 2004-04           11</span></span>
<span><span class="co">#&gt; 5 2004-05            5</span></span>
<span><span class="co">#&gt; 6 2004-06            8</span></span>
<span><span class="co">#&gt; # ℹ 196 more rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Use a <code>lubridate</code> function with the <code>truncated</code> option to convert the <code>Month</code> variable to be in the <code>&lt;date&gt;</code> format.</p>
<p><strong>Class Exercise 2</strong>. Make a plot of the popularity of Data Science through Time. Add a smoother to your plot. What patterns do you notice?</p>
<p><strong>Class Exercise 3</strong>. Modify the code in the tutorial section on the Stocks data to get a data frame on stock prices for the now infamous Gamestop stock. Construct a line plot of the price through time.</p>
<p><strong>Class Exercise 4</strong>. Use the <code><a href="https://dplyr.tidyverse.org/reference/lead-lag.html">lag()</a></code> function to create a new variable that is the previous day’s stock price. Can you predict the current stock price based on the previous day’s stock price accurately? Why or why not? Use either graphical or numerical evidence.</p>
</section><section id="your-turn" class="level3" data-number="12.3.2"><h3 data-number="12.3.2" class="anchored" data-anchor-id="your-turn">
<span class="header-section-number">12.3.2</span> Your Turn</h3>
<p>The data in the Class Exercises was obtained from Google Trends: <a href="https://trends.google.com/trends/?geo=US" target="_blank">Google Trends</a>. Google Trends is incredibly cool to explore, even without <code>R</code>.</p>
<p><strong>Your Turn 1</strong>. On Google Trends, Enter in a search term, and change the Time dropdown menu to be 2004-present. Then, enter in a second search term that you want to compare. You can also change the country if you want to (or, you can keep the country as United States).</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>My search terms will be “super smash” and “animal crossing”, but yours should be something that interests you!</p>
</div>
</div>
<p>In the top-right window of the graph, you should click the down arrow to download the data set. Delete the first two rows of your data set (either in Excel or <code>R</code>), read in the data set, and change the date variable so that it’s in a Date format.</p>
<p><strong>Your Turn 2</strong>. Make a plot of your Popularity variables through time.</p>
<div class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hint (only if you get stuck)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>You will need to use a function from <code>tidyr</code> to tidy the data set first.</p>
</div>
</div>
</div>
<p><strong>Your Turn 3</strong>. Using your data set that explored a variable or two from 2004 through now, make a table of the <strong>average</strong> popularity for each year.</p>
<div class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hint (only if you get stuck)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>You’ll need a <code>lubridate</code> function to extract the year variable from the date object.</p>
</div>
</div>
</div>
<p><strong>Your Turn 4</strong>. Clear your search and now enter a search term that you’d like to investigate for the past 90 days. Mine will be “Pittsburgh Steelers” but, again, yours should be something that interests you.</p>
<p>Again, click the download button again and read in the data to <code>R</code>. Convert the date variable to be in <code>&lt;date&gt;</code> format.</p>
<p><strong>Your Turn 5</strong>. Make a plot of your popularity variable through time, adding a smoother.</p>
<p><strong>Your Turn 6</strong>. Using your data set that explored a variable from the past 90 days, construct a table that compares the <strong>average</strong> popularity on each day of the week (Monday through Saturday).</p>
<p><strong>Your Turn 7</strong>. Examine the <code>ds_df</code> data set again, the data set on data science in Google Trends, and suppose that you have an observation for <strong>each</strong> day of every year (not just one observation per month). You want to look at whether data science is more popular on certain days of the week. Explain why the following strategy <strong>wouldn’t</strong> really work that well.</p>
<ul>
<li>create a weekday variable with <code><a href="https://lubridate.tidyverse.org/reference/day.html">wday()</a></code>
</li>
<li>use <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code> to find the average popularity for each day of the week</li>
</ul>


</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./10-merging.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Merging with <code>dplyr</code></span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./12-stringr.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Text Data with <code>tidytext</code> and <code>stringr</code></span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">Course Materials were written by Matt Higham for STAT/DATA 234 at St.&nbsp;Lawrence University.</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">This book was built with <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>


</body></html>