<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title> 13 Dates with lubridate | STAT 234: Data Science</title>
<meta name="author" content="Matt Higham">
<meta name="description" content="Goals: use lubridate functions to convert a character variable to a &lt;date&gt; variable. use lubridate functions to extract useful information from a &lt;date&gt; variable, including the year, month, day of...">
<meta name="generator" content="bookdown 0.27 with bs4_book()">
<meta property="og:title" content=" 13 Dates with lubridate | STAT 234: Data Science">
<meta property="og:type" content="book">
<meta property="og:url" content="https://highamm.github.io/datascience234/dates-with-lubridate.html">
<meta property="og:description" content="Goals: use lubridate functions to convert a character variable to a &lt;date&gt; variable. use lubridate functions to extract useful information from a &lt;date&gt; variable, including the year, month, day of...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content=" 13 Dates with lubridate | STAT 234: Data Science">
<meta name="twitter:description" content="Goals: use lubridate functions to convert a character variable to a &lt;date&gt; variable. use lubridate functions to extract useful information from a &lt;date&gt; variable, including the year, month, day of...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.5.1/tabs.js"></script><script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="bs4_style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">STAT 234: Data Science</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Syllabus and Course Information</a></li>
<li class="book-part">The Core: tidyverse Basics</li>
<li><a class="" href="intro.html"><span class="header-section-number">2</span> Getting Started with R and R Studio</a></li>
<li><a class="" href="ggplot2.html"><span class="header-section-number">3</span> Plotting with ggplot2</a></li>
<li><a class="" href="dplyr.html"><span class="header-section-number">4</span> Wrangling with dplyr</a></li>
<li><a class="" href="communication-with-quarto.html"><span class="header-section-number">5</span> Communication with Quarto</a></li>
<li><a class="" href="workflow.html"><span class="header-section-number">6</span> Workflow and Other Skills</a></li>
<li class="book-part">Data Wrangling</li>
<li><a class="" href="tidying-with-tidyr.html"><span class="header-section-number">7</span> Tidying with tidyr</a></li>
<li><a class="" href="coding-in-base-r.html"><span class="header-section-number">8</span> Coding in Base R</a></li>
<li><a class="" href="factors-with-forcats.html"><span class="header-section-number">9</span> Factors with forcats</a></li>
<li><a class="" href="data-ethics.html"><span class="header-section-number">10</span> Data Ethics</a></li>
<li><a class="" href="data-import.html"><span class="header-section-number">11</span> Data Import</a></li>
<li><a class="" href="merging-with-dplyr.html"><span class="header-section-number">12</span> Merging with dplyr</a></li>
<li class="book-part">Special Topics</li>
<li><a class="active" href="dates-with-lubridate.html"><span class="header-section-number">13</span> Dates with lubridate</a></li>
<li><a class="" href="text-data-with-tidytext-and-stringr.html"><span class="header-section-number">14</span> Text Data with tidytext and stringr</a></li>
<li><a class="" href="predictive-modeling-with-knn.html"><span class="header-section-number">15</span> Predictive Modeling with knn</a></li>
<li><a class="" href="connections-to-stat-113-stat-213-and-cs-140.html"><span class="header-section-number">16</span> Connections to STAT 113, STAT 213, and CS 140</a></li>
<li><a class="" href="introduction-to-sql-with-dbplyr.html"><span class="header-section-number">17</span> Introduction to SQL with dbplyr</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="dates-with-lubridate" class="section level1" number="13">
<h1>
<span class="header-section-number"> 13</span> Dates with <code>lubridate</code><a class="anchor" aria-label="anchor" href="#dates-with-lubridate"><i class="fas fa-link"></i></a>
</h1>
<p><strong>Goals</strong>:</p>
<ul>
<li>use <code>lubridate</code> functions to convert a character variable to a <code>&lt;date&gt;</code> variable.</li>
<li>use <code>lubridate</code> functions to extract useful information from a <code>&lt;date&gt;</code> variable, including the year, month, day of the week, and day of the year.</li>
</ul>
<div id="converting-variables-to-date" class="section level2" number="13.1">
<h2>
<span class="header-section-number">13.1</span> Converting Variables to <code>&lt;date&gt;</code><a class="anchor" aria-label="anchor" href="#converting-variables-to-date"><i class="fas fa-link"></i></a>
</h2>
<p>The <code>lubridate</code> package is built to easily work with <code>Date</code> objects and <code>DateTime</code> objects. <code>R</code> does not actually have a class that stores <code>Time</code> objects (unless you install a separate package). Dates tend to be much more common than Times, so, we will primarily focus on Dates, but most functions we will see have easy extensions to Times.</p>
<p>To begin, install the <code>lubridate</code> package, and load the package with <code><a href="https://rdrr.io/r/base/library.html">library()</a></code>. The <code><a href="https://lubridate.tidyverse.org/reference/now.html">today()</a></code> function prints today’s date while <code><a href="https://lubridate.tidyverse.org/reference/now.html">now()</a></code> prints today’s date and time. These can sometimes be useful in other contexts, but we will just run the code to see how <code>R</code> stores dates and date-times.</p>
<div class="sourceCode" id="cb400"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org">lubridate</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/now.html">today</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "2022-09-14"</span></span>
<span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/now.html">now</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "2022-09-14 22:08:19 EDT"</span></span></code></pre></div>
<p>This first section will deal with how to convert a variable in <code>R</code> to be a <code>Date</code>. We will use a data set that has the holidays of Animal Crossing from January to April. The columns in this data set are:</p>
<ul>
<li>
<code>Holiday</code>, the name of the holiday and</li>
<li>various other columns with different date formats</li>
</ul>
<p>Read in the data set with</p>
<div class="sourceCode" id="cb401"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/">here</a></span><span class="op">)</span></span>
<span><span class="va">holiday_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data/animal_crossing_holidays.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">holiday_df</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 10</span></span>
<span><span class="co">#&gt;   Holiday    Date1 Date2 Date3 Date4 Date5 Month  Year   Day</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 New Year'… 1-Ja… Jan-… 1/1/… 1/1/… 2020…     1  2020     1</span></span>
<span><span class="co">#&gt; 2 Groundhog… 2-Fe… Feb-… 2/2/… 2/2/… 2020…     2  2020     2</span></span>
<span><span class="co">#&gt; 3 Valentine… 14-F… Feb-… 2/14… 2020… 2020…     2  2020    14</span></span>
<span><span class="co">#&gt; 4 Shamrock … 17-M… Mar-… 3/17… 2020… 2020…     3  2020    17</span></span>
<span><span class="co">#&gt; 5 Bunny Day  12-A… Apr-… 4/12… 12/4… 2020…     4  2020    12</span></span>
<span><span class="co">#&gt; 6 Earth Day  22-A… Apr-… 4/22… 2020… 2020…     4  2020    22</span></span>
<span><span class="co">#&gt; # … with 1 more variable: Month2 &lt;chr&gt;</span></span>
<span><span class="co">#&gt; # ℹ Use `colnames()` to see all variable names</span></span></code></pre></div>
<p>Which columns were specified as Dates? In this example, none of the columns have the <code>&lt;date&gt;</code> specification: all of the date columns are read in as character variables.</p>
<div id="from-chr-to-date" class="section level3" number="13.1.1">
<h3>
<span class="header-section-number">13.1.1</span> From <code>&lt;chr&gt;</code> to <code>&lt;date&gt;</code><a class="anchor" aria-label="anchor" href="#from-chr-to-date"><i class="fas fa-link"></i></a>
</h3>
<p>We will use the <code><a href="https://lubridate.tidyverse.org/reference/ymd.html">dmy()</a></code> series of functions in <code>lubridate</code> to convert character variables to dates. We will typically pair this new function with a <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> statement: much like the <code>forcats</code> functions, we are almost always <strong>creating</strong> a new variable.</p>
<p>There are a series of <code><a href="https://lubridate.tidyverse.org/reference/ymd.html">dmy()</a></code>-type variables, each corresponding to a different Day-Month-Year order.</p>
<ul>
<li>
<code><a href="https://lubridate.tidyverse.org/reference/ymd.html">dmy()</a></code> is used to parse a date from a character vector that has the day first, month second, and year last.</li>
<li>
<code><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd()</a></code> is used to parse a date that has year first, month second, and date last</li>
<li>
<code><a href="https://lubridate.tidyverse.org/reference/ymd.html">ydm()</a></code> is used to parse a date that has year first, day second, and month last,….</li>
</ul>
<p>and <code><a href="https://lubridate.tidyverse.org/reference/ymd.html">dym()</a></code>, <code><a href="https://lubridate.tidyverse.org/reference/ymd.html">mdy()</a></code>, and <code><a href="https://lubridate.tidyverse.org/reference/ymd.html">myd()</a></code> work similarly. <code>lubridate</code> is usually “smart” and picks up dates in all kinds of different formats (e.g. it can pick up specifying <code>October</code> as the month and <code>Oct</code> as the month and <code>10</code> as the month).</p>
<p>Let’s try it out on <code>Date1</code> and <code>Date2</code>:</p>
<div class="sourceCode" id="cb402"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">holiday_df</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Date_test <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">dmy</a></span><span class="op">(</span><span class="va">Date1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Date_test</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 11</span></span>
<span><span class="co">#&gt;   Date_test  Holiday     Date1 Date2 Date3 Date4 Date5 Month</span></span>
<span><span class="co">#&gt;   &lt;date&gt;     &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 2020-01-01 New Year's… 1-Ja… Jan-… 1/1/… 1/1/… 2020…     1</span></span>
<span><span class="co">#&gt; 2 2020-02-02 Groundhog … 2-Fe… Feb-… 2/2/… 2/2/… 2020…     2</span></span>
<span><span class="co">#&gt; 3 2020-02-14 Valentine'… 14-F… Feb-… 2/14… 2020… 2020…     2</span></span>
<span><span class="co">#&gt; 4 2020-03-17 Shamrock D… 17-M… Mar-… 3/17… 2020… 2020…     3</span></span>
<span><span class="co">#&gt; 5 2020-04-12 Bunny Day   12-A… Apr-… 4/12… 12/4… 2020…     4</span></span>
<span><span class="co">#&gt; 6 2020-04-22 Earth Day   22-A… Apr-… 4/22… 2020… 2020…     4</span></span>
<span><span class="co">#&gt; # … with 3 more variables: Year &lt;dbl&gt;, Day &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   Month2 &lt;chr&gt;</span></span>
<span><span class="co">#&gt; # ℹ Use `colnames()` to see all variable names</span></span>
<span><span class="va">holiday_df</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Date_test <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">mdy</a></span><span class="op">(</span><span class="va">Date2</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Date_test</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 11</span></span>
<span><span class="co">#&gt;   Date_test  Holiday     Date1 Date2 Date3 Date4 Date5 Month</span></span>
<span><span class="co">#&gt;   &lt;date&gt;     &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 2020-01-01 New Year's… 1-Ja… Jan-… 1/1/… 1/1/… 2020…     1</span></span>
<span><span class="co">#&gt; 2 2020-02-02 Groundhog … 2-Fe… Feb-… 2/2/… 2/2/… 2020…     2</span></span>
<span><span class="co">#&gt; 3 2020-02-14 Valentine'… 14-F… Feb-… 2/14… 2020… 2020…     2</span></span>
<span><span class="co">#&gt; 4 2020-03-17 Shamrock D… 17-M… Mar-… 3/17… 2020… 2020…     3</span></span>
<span><span class="co">#&gt; 5 2020-04-12 Bunny Day   12-A… Apr-… 4/12… 12/4… 2020…     4</span></span>
<span><span class="co">#&gt; 6 2020-04-22 Earth Day   22-A… Apr-… 4/22… 2020… 2020…     4</span></span>
<span><span class="co">#&gt; # … with 3 more variables: Year &lt;dbl&gt;, Day &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   Month2 &lt;chr&gt;</span></span>
<span><span class="co">#&gt; # ℹ Use `colnames()` to see all variable names</span></span></code></pre></div>
<p><strong>A Reminder</strong>: Why do <code>&lt;date&gt;</code> objects even matter? Compare the following two plots: one made where the date is in <code>&lt;chr&gt;</code> form and the other where date is in its appropriate <code>&lt;date&gt;</code> form.</p>
<div class="sourceCode" id="cb403"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">holiday_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Date1</span>, y <span class="op">=</span> <span class="va">Holiday</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="11-lubridate_files/figure-html/unnamed-chunk-4-1.png" width="672"></div>
<div class="sourceCode" id="cb404"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">holiday_df</span> <span class="op">&lt;-</span> <span class="va">holiday_df</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Date_test_plot <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">dmy</a></span><span class="op">(</span><span class="va">Date1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Date_test_plot</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">holiday_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Date_test_plot</span>, y <span class="op">=</span> <span class="va">Holiday</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="11-lubridate_files/figure-html/unnamed-chunk-4-2.png" width="672"></div>
<p>In which plot does the ordering on the x-axis make more sense?</p>
</div>
<div id="making-a-date-variable-from-date-components" class="section level3" number="13.1.2">
<h3>
<span class="header-section-number">13.1.2</span> Making a <code>&lt;date&gt;</code> variable from Date Components<a class="anchor" aria-label="anchor" href="#making-a-date-variable-from-date-components"><i class="fas fa-link"></i></a>
</h3>
<p>Another way to create a Date object is to assemble it with <code><a href="https://lubridate.tidyverse.org/reference/make_datetime.html">make_date()</a></code> from a month, day, and year components, each stored in a separate column:</p>
<div class="sourceCode" id="cb405"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">holiday_df</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Date_test2 <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/make_datetime.html">make_date</a></span><span class="op">(</span>year <span class="op">=</span> <span class="va">Year</span>,</span>
<span>                                             month <span class="op">=</span> <span class="va">Month</span>,</span>
<span>                                             day <span class="op">=</span> <span class="va">Day</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Date_test2</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 12</span></span>
<span><span class="co">#&gt;   Date_test2 Date_test_plot Holiday  Date1 Date2 Date3 Date4</span></span>
<span><span class="co">#&gt;   &lt;date&gt;     &lt;date&gt;         &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1 2020-01-01 2020-01-01     New Yea… 1-Ja… Jan-… 1/1/… 1/1/…</span></span>
<span><span class="co">#&gt; 2 2020-02-02 2020-02-02     Groundh… 2-Fe… Feb-… 2/2/… 2/2/…</span></span>
<span><span class="co">#&gt; 3 2020-02-14 2020-02-14     Valenti… 14-F… Feb-… 2/14… 2020…</span></span>
<span><span class="co">#&gt; 4 2020-03-17 2020-03-17     Shamroc… 17-M… Mar-… 3/17… 2020…</span></span>
<span><span class="co">#&gt; 5 2020-04-12 2020-04-12     Bunny D… 12-A… Apr-… 4/12… 12/4…</span></span>
<span><span class="co">#&gt; 6 2020-04-22 2020-04-22     Earth D… 22-A… Apr-… 4/22… 2020…</span></span>
<span><span class="co">#&gt; # … with 5 more variables: Date5 &lt;chr&gt;, Month &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   Year &lt;dbl&gt;, Day &lt;dbl&gt;, Month2 &lt;chr&gt;</span></span>
<span><span class="co">#&gt; # ℹ Use `colnames()` to see all variable names</span></span></code></pre></div>
<p>But, when <code>Month</code> is stored as a character (e.g. <code>February</code>) instead of a number (e.g. <code>2</code>), problems arise with the <code><a href="https://lubridate.tidyverse.org/reference/make_datetime.html">make_date()</a></code> function:</p>
<div class="sourceCode" id="cb406"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">holiday_df</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Date_test2 <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/make_datetime.html">make_date</a></span><span class="op">(</span>year <span class="op">=</span> <span class="va">Year</span>,</span>
<span>                                             month <span class="op">=</span> <span class="va">Month2</span>,</span>
<span>                                             day <span class="op">=</span> <span class="va">Day</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Date_test2</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 12</span></span>
<span><span class="co">#&gt;   Date_test2 Date_test_plot Holiday  Date1 Date2 Date3 Date4</span></span>
<span><span class="co">#&gt;   &lt;date&gt;     &lt;date&gt;         &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1 NA         2020-01-01     New Yea… 1-Ja… Jan-… 1/1/… 1/1/…</span></span>
<span><span class="co">#&gt; 2 NA         2020-02-02     Groundh… 2-Fe… Feb-… 2/2/… 2/2/…</span></span>
<span><span class="co">#&gt; 3 NA         2020-02-14     Valenti… 14-F… Feb-… 2/14… 2020…</span></span>
<span><span class="co">#&gt; 4 NA         2020-03-17     Shamroc… 17-M… Mar-… 3/17… 2020…</span></span>
<span><span class="co">#&gt; 5 NA         2020-04-12     Bunny D… 12-A… Apr-… 4/12… 12/4…</span></span>
<span><span class="co">#&gt; 6 NA         2020-04-22     Earth D… 22-A… Apr-… 4/22… 2020…</span></span>
<span><span class="co">#&gt; # … with 5 more variables: Date5 &lt;chr&gt;, Month &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   Year &lt;dbl&gt;, Day &lt;dbl&gt;, Month2 &lt;chr&gt;</span></span>
<span><span class="co">#&gt; # ℹ Use `colnames()` to see all variable names</span></span></code></pre></div>
<p>So the <code><a href="https://lubridate.tidyverse.org/reference/make_datetime.html">make_date()</a></code> function requires a specific format for the year, month, and day columns. It may take a little pre-processing to put a particular data set in that format.</p>
</div>
<div id="exercise-11-1" class="section level3" number="13.1.3">
<h3>
<span class="header-section-number">13.1.3</span> Exercises<a class="anchor" aria-label="anchor" href="#exercise-11-1"><i class="fas fa-link"></i></a>
</h3>
<p>Exercises marked with an * indicate that the exercise has a solution at the end of the chapter at <a href="dates-with-lubridate.html#solutions-11">13.4</a>.</p>
<ol style="list-style-type: decimal">
<li>* What’s the issue with trying to convert <code>Date4</code> to a <code>&lt;date&gt;</code> form? You may want to investigate <code>Date4</code> further to answer this question.</li>
</ol>
<div class="sourceCode" id="cb407"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">holiday_df</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Date_test <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="va">Date4</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Date_test</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 12</span></span>
<span><span class="co">#&gt;   Date_test  Date_test_plot Holiday  Date1 Date2 Date3 Date4</span></span>
<span><span class="co">#&gt;   &lt;date&gt;     &lt;date&gt;         &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1 2001-01-20 2020-01-01     New Yea… 1-Ja… Jan-… 1/1/… 1/1/…</span></span>
<span><span class="co">#&gt; 2 2002-02-20 2020-02-02     Groundh… 2-Fe… Feb-… 2/2/… 2/2/…</span></span>
<span><span class="co">#&gt; 3 NA         2020-02-14     Valenti… 14-F… Feb-… 2/14… 2020…</span></span>
<span><span class="co">#&gt; 4 NA         2020-03-17     Shamroc… 17-M… Mar-… 3/17… 2020…</span></span>
<span><span class="co">#&gt; 5 2012-04-20 2020-04-12     Bunny D… 12-A… Apr-… 4/12… 12/4…</span></span>
<span><span class="co">#&gt; 6 NA         2020-04-22     Earth D… 22-A… Apr-… 4/22… 2020…</span></span>
<span><span class="co">#&gt; # … with 5 more variables: Date5 &lt;chr&gt;, Month &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   Year &lt;dbl&gt;, Day &lt;dbl&gt;, Month2 &lt;chr&gt;</span></span>
<span><span class="co">#&gt; # ℹ Use `colnames()` to see all variable names</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>* Practice converting <code>Date3</code> and <code>Date5</code> to <code>&lt;date&gt;</code> variables with <code>lubridate</code> functions.</li>
</ol>
</div>
</div>
<div id="functions-for-date-variables" class="section level2" number="13.2">
<h2>
<span class="header-section-number">13.2</span> Functions for <code>&lt;date&gt;</code> Variables<a class="anchor" aria-label="anchor" href="#functions-for-date-variables"><i class="fas fa-link"></i></a>
</h2>
<p>Once an object is in the <code>&lt;date&gt;</code> format, there are some special functions in <code>lubridate</code> that can be used on that date variable. To investigate some of these functions, we will pull stock market data from Yahoo using the <code>quantmod</code> package. Install the package, and run the following code, which gets stock market price data on Apple, Nintendo, Chipotle, and the S &amp; P 500 Index from 2011 to now. Note that you have the ability to understand all of the code below, but we will skip over this code for now to focus more on the new information in this section (information about date functions).</p>
<div class="sourceCode" id="cb408"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## install.packages("quantmod")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.quantmod.com">quantmod</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="st">"2011-01-01"</span><span class="op">)</span></span>
<span><span class="va">end</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="st">"2021-5-19"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/quantmod/man/getSymbols.html">getSymbols</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AAPL"</span>, <span class="st">"NTDOY"</span>, <span class="st">"CMG"</span>, <span class="st">"SPY"</span><span class="op">)</span>, src <span class="op">=</span> <span class="st">"yahoo"</span>,</span>
<span>           from <span class="op">=</span> <span class="va">start</span>, to <span class="op">=</span> <span class="va">end</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "AAPL"  "NTDOY" "CMG"   "SPY"</span></span>
<span></span>
<span><span class="va">date_tib</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/zoo/man/index.html">index</a></span><span class="op">(</span><span class="va">AAPL</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>start_date <span class="op">=</span> <span class="va">value</span><span class="op">)</span></span>
<span><span class="va">app_tib</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="va">AAPL</span><span class="op">)</span></span>
<span><span class="va">nint_tib</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="va">NTDOY</span><span class="op">)</span></span>
<span><span class="va">chip_tib</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="va">CMG</span><span class="op">)</span></span>
<span><span class="va">spy_tib</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="va">SPY</span><span class="op">)</span></span>
<span><span class="va">all_stocks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_cols</a></span><span class="op">(</span><span class="va">date_tib</span>, <span class="va">app_tib</span>, <span class="va">nint_tib</span>, <span class="va">chip_tib</span>, <span class="va">spy_tib</span><span class="op">)</span></span>
<span></span>
<span><span class="va">stocks_long</span> <span class="op">&lt;-</span> <span class="va">all_stocks</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">start_date</span>, <span class="va">AAPL.Adjusted</span>, <span class="va">NTDOY.Adjusted</span>,</span>
<span>                      <span class="va">CMG.Adjusted</span>, <span class="va">SPY.Adjusted</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">5</span>, names_to <span class="op">=</span> <span class="st">"Stock_Type"</span>, values_to <span class="op">=</span> <span class="st">"Price"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Stock_Type <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_recode.html">fct_recode</a></span><span class="op">(</span><span class="va">Stock_Type</span>,</span>
<span>                                 Apple <span class="op">=</span> <span class="st">"AAPL.Adjusted"</span>,</span>
<span>                                 Nintendo <span class="op">=</span> <span class="st">"NTDOY.Adjusted"</span>,</span>
<span>                                 Chipotle <span class="op">=</span> <span class="st">"CMG.Adjusted"</span>,</span>
<span>                                 `S &amp; P 500` <span class="op">=</span> <span class="st">"SPY.Adjusted"</span></span>
<span>                                 <span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="va">stocks_long</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 3</span></span>
<span><span class="co">#&gt;   start_date Stock_Type  Price</span></span>
<span><span class="co">#&gt;   &lt;date&gt;     &lt;fct&gt;       &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 2021-05-17 Chipotle   1332. </span></span>
<span><span class="co">#&gt; 2 2021-05-17 S &amp; P 500   408. </span></span>
<span><span class="co">#&gt; 3 2021-05-18 Apple       124. </span></span>
<span><span class="co">#&gt; 4 2021-05-18 Nintendo     70.4</span></span>
<span><span class="co">#&gt; 5 2021-05-18 Chipotle   1325. </span></span>
<span><span class="co">#&gt; 6 2021-05-18 S &amp; P 500   405.</span></span></code></pre></div>
<p>You’ll have a chance in the Exercises to choose your own stocks to investigate. For now, I’ve made a data set with three variables:</p>
<ul>
<li>
<code>start_date</code>, the opening date for the stock market</li>
<li>
<code>Stock_Type</code>, a factor with 4 levels: <code>Apple</code>, <code>Nintendo</code>, <code>Chipotle</code>, and <code>S &amp; P 500</code>
</li>
<li>
<code>Price</code>, the price of the stock?</li>
</ul>
<p>First, let’s make a line plot that shows how the S &amp; P 500 has changed over time:</p>
<div class="sourceCode" id="cb409"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stocks_sp</span> <span class="op">&lt;-</span> <span class="va">stocks_long</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Stock_Type</span> <span class="op">==</span> <span class="st">"S &amp; P 500"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">stocks_sp</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">start_date</span>, y <span class="op">=</span> <span class="va">Price</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="11-lubridate_files/figure-html/unnamed-chunk-9-1.png" width="672"></div>
<p>But, there’s other information that we can get from the <code>start_date</code> variable. We might be interested in things like day of the week, monthly trends, or yearly trends. To extract variables like “weekday” and “month” from a <code>&lt;date&gt;</code> variable, there are a series of functions that are fairly straightforward to use. We will discuss the <code><a href="https://lubridate.tidyverse.org/reference/year.html">year()</a></code> <code><a href="https://lubridate.tidyverse.org/reference/month.html">month()</a></code>, <code><a href="https://lubridate.tidyverse.org/reference/day.html">mday()</a></code>, <code><a href="https://lubridate.tidyverse.org/reference/day.html">yday()</a></code>, and <code><a href="https://lubridate.tidyverse.org/reference/day.html">wday()</a></code> functions.</p>
<div id="year-month-and-mday" class="section level3" number="13.2.1">
<h3>
<span class="header-section-number">13.2.1</span> <code>year()</code>, <code>month()</code>, and <code>mday()</code><a class="anchor" aria-label="anchor" href="#year-month-and-mday"><i class="fas fa-link"></i></a>
</h3>
<p>The functions <code><a href="https://lubridate.tidyverse.org/reference/year.html">year()</a></code>, <code><a href="https://lubridate.tidyverse.org/reference/month.html">month()</a></code>, and <code><a href="https://lubridate.tidyverse.org/reference/day.html">mday()</a></code> can grab the year, month, and day of the month, respectively, from a <code>&lt;date&gt;</code> variable. Like the <code>forcats</code> functions, these will almost always be paired with a <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> statement because they will create a new variable:</p>
<div class="sourceCode" id="cb410"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stocks_long</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>year_stock <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/year.html">year</a></span><span class="op">(</span><span class="va">start_date</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">stocks_long</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>month_stock <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/month.html">month</a></span><span class="op">(</span><span class="va">start_date</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">stocks_long</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>day_stock <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/day.html">mday</a></span><span class="op">(</span><span class="va">start_date</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="yday-and-wday" class="section level3" number="13.2.2">
<h3>
<span class="header-section-number">13.2.2</span> <code>yday()</code> and <code>wday()</code><a class="anchor" aria-label="anchor" href="#yday-and-wday"><i class="fas fa-link"></i></a>
</h3>
<p>The <code><a href="https://lubridate.tidyverse.org/reference/day.html">yday()</a></code> function grabs the day of the year from a <code>&lt;date&gt;</code> object. For example,</p>
<div class="sourceCode" id="cb411"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">mdy</a></span><span class="op">(</span><span class="st">"November 4, 2020"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/day.html">yday</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 309</span></span></code></pre></div>
<p>returns <code>309</code>, indicating that November 4th is the 309th day of the year 2020. Using this function in a <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> statement creates a new variable that has <code>yday</code> for each observation:</p>
<div class="sourceCode" id="cb412"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stocks_long</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>day_in_year <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/day.html">yday</a></span><span class="op">(</span><span class="va">start_date</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 10,444 × 4</span></span>
<span><span class="co">#&gt;    start_date Stock_Type Price day_in_year</span></span>
<span><span class="co">#&gt;    &lt;date&gt;     &lt;fct&gt;      &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 2011-01-03 Apple       10.0           3</span></span>
<span><span class="co">#&gt;  2 2011-01-03 Nintendo    36.7           3</span></span>
<span><span class="co">#&gt;  3 2011-01-03 Chipotle   224.            3</span></span>
<span><span class="co">#&gt;  4 2011-01-03 S &amp; P 500  102.            3</span></span>
<span><span class="co">#&gt;  5 2011-01-04 Apple       10.1           4</span></span>
<span><span class="co">#&gt;  6 2011-01-04 Nintendo    35.5           4</span></span>
<span><span class="co">#&gt;  7 2011-01-04 Chipotle   222.            4</span></span>
<span><span class="co">#&gt;  8 2011-01-04 S &amp; P 500  102.            4</span></span>
<span><span class="co">#&gt;  9 2011-01-05 Apple       10.2           5</span></span>
<span><span class="co">#&gt; 10 2011-01-05 Nintendo    34.6           5</span></span>
<span><span class="co">#&gt; # … with 10,434 more rows</span></span>
<span><span class="co">#&gt; # ℹ Use `print(n = ...)` to see more rows</span></span></code></pre></div>
<p>Finally, the function <code><a href="https://lubridate.tidyverse.org/reference/day.html">wday()</a></code> grabs the day of the week from a <code>&lt;date&gt;</code>. By default, <code><a href="https://lubridate.tidyverse.org/reference/day.html">wday()</a></code> puts the day of the week as a numeric, but I find this confusing, as I can’t ever remember whether a <code>1</code> means <code>Sunday</code> or a <code>1</code> means <code>Monday</code>. Adding, <code>label = TRUE</code> creates the weekday variable as <code>Sunday</code>, <code>Monday</code>, <code>Tuesday</code>, etc.:</p>
<div class="sourceCode" id="cb413"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stocks_long</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>day_of_week <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/day.html">wday</a></span><span class="op">(</span><span class="va">start_date</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">stocks_long</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>day_of_week <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/day.html">wday</a></span><span class="op">(</span><span class="va">start_date</span>,</span>
<span>                                          label <span class="op">=</span> <span class="cn">TRUE</span>, abbr <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Possible uses for these functions are:</p>
<ul>
<li><p>you want to look at differences between years (with <code><a href="https://lubridate.tidyverse.org/reference/year.html">year()</a></code>)</p></li>
<li><p>you want to look at differences between months (with <code><a href="https://lubridate.tidyverse.org/reference/month.html">month()</a></code>)</p></li>
<li><p>you want to look at differences between days of the week (with <code><a href="https://lubridate.tidyverse.org/reference/day.html">wday()</a></code>)</p></li>
<li><p>you want to see whether there are yearly trends <strong>within years</strong> (with <code><a href="https://lubridate.tidyverse.org/reference/day.html">yday()</a></code>)</p></li>
</ul>
<p><strong>Note</strong>: Working with times is extremely similar to working with dates. Instead of <code><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd()</a></code>, <code><a href="https://lubridate.tidyverse.org/reference/ymd.html">mdy()</a></code>, etc., you tack on a few extra letters to specify the order that the hour, minute, and seconds appear in the variable: <code><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html">ymd_hms()</a></code> converts a character vector that has the order year, month, day, hour, minute, second to a <code>&lt;datetime&gt;</code>.</p>
<p>Additionally, the functions <code><a href="https://lubridate.tidyverse.org/reference/hour.html">hour()</a></code>, <code><a href="https://lubridate.tidyverse.org/reference/minute.html">minute()</a></code>, and <code><a href="https://lubridate.tidyverse.org/reference/second.html">second()</a></code> grab the hour, minute, and second from a <code>&lt;datetime&gt;</code> variable.</p>
<p><strong>Note on Complications</strong>: Things can get complicated, especially if you start to consider things like time <strong>duration</strong>. The reason is that our time system is inherently confusing. Consider how the following might affect an analysis involving time duration:</p>
<ul>
<li>time zones</li>
<li>leap years (not all years have the same number of days)</li>
<li>differing number of days in a given month</li>
<li>daylight saving time (not all days have the same number of hours)</li>
</ul>
</div>
<div id="exercise-11-2" class="section level3" number="13.2.3">
<h3>
<span class="header-section-number">13.2.3</span> Exercises<a class="anchor" aria-label="anchor" href="#exercise-11-2"><i class="fas fa-link"></i></a>
</h3>
<p>Exercises marked with an * indicate that the exercise has a solution at the end of the chapter at <a href="dates-with-lubridate.html#solutions-11">13.4</a>.</p>
<ol style="list-style-type: decimal">
<li>The <code><a href="https://lubridate.tidyverse.org/reference/month.html">month()</a></code> function gives the numbers corresponding to each month by default. Type <code><a href="https://lubridate.tidyverse.org/reference/month.html">?month</a></code> and figure out which argument you would need to change to get the <strong>names</strong> (January, February, etc.) instead of the month numbers. What about the <strong>abbreviations</strong> (Jan, Feb, etc.) of each month instead of the month numbers? Try making the changes in the <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> statement below.</li>
</ol>
<div class="sourceCode" id="cb414"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stocks_long</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>month_stock <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/month.html">month</a></span><span class="op">(</span><span class="va">start_date</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div id="chapexercise-11" class="section level2" number="13.3">
<h2>
<span class="header-section-number">13.3</span> Chapter Exercises<a class="anchor" aria-label="anchor" href="#chapexercise-11"><i class="fas fa-link"></i></a>
</h2>
<p>Exercises marked with an * indicate that the exercise has a solution at the end of the chapter at <a href="dates-with-lubridate.html#solutions-11">13.4</a>.</p>
<p>The <code>truncated</code> argument to <code><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd()</a></code>, <code><a href="https://lubridate.tidyverse.org/reference/ymd.html">dmy()</a></code>, <code><a href="https://lubridate.tidyverse.org/reference/ymd.html">mdy()</a></code>, etc. will allow <code>R</code> to parse dates that aren’t actually complete. For example,</p>
<div class="sourceCode" id="cb415"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org">lubridate</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="st">"2019"</span>, truncated <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "2019-01-01"</span></span></code></pre></div>
<p>parses <code>2019</code> to be January 1, 2019 when the month and day are missing. The <code>2</code> means that the last two parts of the date (in this case, month and day) are allowed to be missing. Similarly,</p>
<div class="sourceCode" id="cb416"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">dmy</a></span><span class="op">(</span><span class="st">"19-10"</span>, truncated <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "0000-10-19"</span></span></code></pre></div>
<p>truncates the year (which is given as 0000). The truncate function is usually most useful in the context of the first example with a truncated month and/or day.</p>
<p>Examine the <code>ds_google.csv</code>, which contains</p>
<ul>
<li>
<code>Month</code>, the year and month from 2004 to now</li>
<li>
<code>Data_Science</code>, the relative popularity of data science (Google keeps how it calculates “popularity” as somewhat of a mystery but it is likely based off of the number of times people search for the term “Data Science”)</li>
</ul>
<div class="sourceCode" id="cb417"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org">lubridate</a></span><span class="op">)</span></span>
<span><span class="va">ds_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data/ds_google.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ds_df</span></span>
<span><span class="co">#&gt; # A tibble: 202 × 2</span></span>
<span><span class="co">#&gt;    Month   Data_Science</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;          &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 2004-01           14</span></span>
<span><span class="co">#&gt;  2 2004-02            8</span></span>
<span><span class="co">#&gt;  3 2004-03           16</span></span>
<span><span class="co">#&gt;  4 2004-04           11</span></span>
<span><span class="co">#&gt;  5 2004-05            5</span></span>
<span><span class="co">#&gt;  6 2004-06            8</span></span>
<span><span class="co">#&gt;  7 2004-07            7</span></span>
<span><span class="co">#&gt;  8 2004-08            9</span></span>
<span><span class="co">#&gt;  9 2004-09           13</span></span>
<span><span class="co">#&gt; 10 2004-10           11</span></span>
<span><span class="co">#&gt; # … with 192 more rows</span></span>
<span><span class="co">#&gt; # ℹ Use `print(n = ...)` to see more rows</span></span></code></pre></div>
<ol style="list-style-type: decimal">
<li><p>* Use a <code>lubridate</code> function with the <code>truncated</code> option to convert the <code>Month</code> variable to be in the <code>&lt;date&gt;</code> format.</p></li>
<li><p>* Make a plot of the popularity of Data Science through Time. Add a smoother to your plot. What patterns do you notice?</p></li>
</ol>
<p>The data was obtained from Google Trends: <a href="https://trends.google.com/trends/?geo=US" target="_blank">Google Trends</a>. Google Trends is incredibly cool to explore, even without <code>R</code>.</p>
<ol start="3" style="list-style-type: decimal">
<li>* On Google Trends, Enter in a search term, and change the Time dropdown menu to be 2004-present. Then, enter in a second search term that you want to compare. You can also change the country if you want to (or, you can keep the country as United States).</li>
</ol>
<p>My search terms will be “super smash” and “animal crossing”, but yours should be something that interests you!</p>
<p>In the top-right window of the graph, you should click the down arrow to download the data set. Delete the first two rows of your data set (either in Excel or <code>R</code>), read in the data set, and change the date variable so that it’s in a Date format.</p>
<ol start="4" style="list-style-type: decimal">
<li><p>* Make a plot of your Popularity variables through time. <strong>Hint</strong>: Does the data set need to be tidied at all first?</p></li>
<li><p>* Using your data set that explored a variable or two from 2004 through now, make a table of the <strong>average</strong> popularity for each year. <strong>Hint</strong>: You’ll need a lubridate function to extract the year variable from the date object.</p></li>
<li><p>* Clear your search and now enter a search term that you’d like to investigate for the past 90 days. Mine will be “Pittsburgh Steelers” but, again, yours should be something that interests you.</p></li>
</ol>
<p>Again, click the download button again and read in the data to <code>R</code>. Convert the date variable to be in <code>&lt;date&gt;</code> format.</p>
<ol start="7" style="list-style-type: decimal">
<li><p>* Make a plot of your popularity variable through time, adding a smoother.</p></li>
<li><p>Using your data set that explored a variable from the past 90 days, construct a table that compares the <strong>average</strong> popularity on each day of the week (Monday through Saturday).</p></li>
<li><p>Examine the <code>ds_df</code> data set again, the data set on data science in Google Trends, and suppose that you have an observation for <strong>each</strong> day of every year (not just one observation per month). You want to look at whether data science is more popular on certain days of the week. Explain why the following strategy <strong>wouldn’t</strong> really work that well.</p></li>
</ol>
<ul>
<li>create a weekday variable with <code><a href="https://lubridate.tidyverse.org/reference/day.html">wday()</a></code>
</li>
<li>use <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code> to find the average popularity for each day of the week</li>
</ul>
<ol start="10" style="list-style-type: decimal">
<li>Use the code in the tutorial section on the Stocks data to get a data frame on stock prices for a couple of different stocks that interest you. The start and end date that you use are completely up to you.</li>
</ol>
<p>Explore the stock data that you chose, constructing a line plot of the price through time, as well as any graphs or summaries that show interesting patterns across years, months, days, days of the week, etc.</p>
<ol start="11" style="list-style-type: decimal">
<li>Use the <code>lag()</code> function to create a new variable that is the previous day’s stock price. Can you predict the current stock price based on the previous day’s stock price accurately? Why or why not? Use either graphical or numerical evidence.</li>
</ol>
</div>
<div id="solutions-11" class="section level2" number="13.4">
<h2>
<span class="header-section-number">13.4</span> Exercise Solutions<a class="anchor" aria-label="anchor" href="#solutions-11"><i class="fas fa-link"></i></a>
</h2>
<div id="converting-variables-to-date-s" class="section level3" number="13.4.1">
<h3>
<span class="header-section-number">13.4.1</span> Converting Variables to <code>&lt;date&gt;</code> S<a class="anchor" aria-label="anchor" href="#converting-variables-to-date-s"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>* What’s the issue with trying to convert <code>Date4</code> to a <code>&lt;date&gt;</code> form?</li>
</ol>
<div class="sourceCode" id="cb418"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">holiday_df</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Date_test <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="va">Date4</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Date_test</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 12</span></span>
<span><span class="co">#&gt;   Date_test  Date_test_plot Holiday  Date1 Date2 Date3 Date4</span></span>
<span><span class="co">#&gt;   &lt;date&gt;     &lt;date&gt;         &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1 2001-01-20 2020-01-01     New Yea… 1-Ja… Jan-… 1/1/… 1/1/…</span></span>
<span><span class="co">#&gt; 2 2002-02-20 2020-02-02     Groundh… 2-Fe… Feb-… 2/2/… 2/2/…</span></span>
<span><span class="co">#&gt; 3 NA         2020-02-14     Valenti… 14-F… Feb-… 2/14… 2020…</span></span>
<span><span class="co">#&gt; 4 NA         2020-03-17     Shamroc… 17-M… Mar-… 3/17… 2020…</span></span>
<span><span class="co">#&gt; 5 2012-04-20 2020-04-12     Bunny D… 12-A… Apr-… 4/12… 12/4…</span></span>
<span><span class="co">#&gt; 6 NA         2020-04-22     Earth D… 22-A… Apr-… 4/22… 2020…</span></span>
<span><span class="co">#&gt; # … with 5 more variables: Date5 &lt;chr&gt;, Month &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   Year &lt;dbl&gt;, Day &lt;dbl&gt;, Month2 &lt;chr&gt;</span></span>
<span><span class="co">#&gt; # ℹ Use `colnames()` to see all variable names</span></span></code></pre></div>
<div class="sourceCode" id="cb419"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Date4 has two __different__ formats, </span></span>
<span><span class="co">## which creates problems for `lubridate` functions</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>* Practice converting <code>Date3</code> and <code>Date5</code> to date objects with <code>lubridate</code> functions.</li>
</ol>
<div class="sourceCode" id="cb420"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">holiday_df</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Date_test <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">mdy</a></span><span class="op">(</span><span class="va">Date3</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Date_test</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 12</span></span>
<span><span class="co">#&gt;   Date_test  Date_test_plot Holiday  Date1 Date2 Date3 Date4</span></span>
<span><span class="co">#&gt;   &lt;date&gt;     &lt;date&gt;         &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1 2020-01-01 2020-01-01     New Yea… 1-Ja… Jan-… 1/1/… 1/1/…</span></span>
<span><span class="co">#&gt; 2 2020-02-02 2020-02-02     Groundh… 2-Fe… Feb-… 2/2/… 2/2/…</span></span>
<span><span class="co">#&gt; 3 2020-02-14 2020-02-14     Valenti… 14-F… Feb-… 2/14… 2020…</span></span>
<span><span class="co">#&gt; 4 2020-03-17 2020-03-17     Shamroc… 17-M… Mar-… 3/17… 2020…</span></span>
<span><span class="co">#&gt; 5 2020-04-12 2020-04-12     Bunny D… 12-A… Apr-… 4/12… 12/4…</span></span>
<span><span class="co">#&gt; 6 2020-04-22 2020-04-22     Earth D… 22-A… Apr-… 4/22… 2020…</span></span>
<span><span class="co">#&gt; # … with 5 more variables: Date5 &lt;chr&gt;, Month &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   Year &lt;dbl&gt;, Day &lt;dbl&gt;, Month2 &lt;chr&gt;</span></span>
<span><span class="co">#&gt; # ℹ Use `colnames()` to see all variable names</span></span>
<span><span class="va">holiday_df</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Date_test <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="va">Date5</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Date_test</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 12</span></span>
<span><span class="co">#&gt;   Date_test  Date_test_plot Holiday  Date1 Date2 Date3 Date4</span></span>
<span><span class="co">#&gt;   &lt;date&gt;     &lt;date&gt;         &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1 2020-01-01 2020-01-01     New Yea… 1-Ja… Jan-… 1/1/… 1/1/…</span></span>
<span><span class="co">#&gt; 2 2020-02-02 2020-02-02     Groundh… 2-Fe… Feb-… 2/2/… 2/2/…</span></span>
<span><span class="co">#&gt; 3 2020-02-14 2020-02-14     Valenti… 14-F… Feb-… 2/14… 2020…</span></span>
<span><span class="co">#&gt; 4 2020-03-17 2020-03-17     Shamroc… 17-M… Mar-… 3/17… 2020…</span></span>
<span><span class="co">#&gt; 5 2020-04-12 2020-04-12     Bunny D… 12-A… Apr-… 4/12… 12/4…</span></span>
<span><span class="co">#&gt; 6 2020-04-22 2020-04-22     Earth D… 22-A… Apr-… 4/22… 2020…</span></span>
<span><span class="co">#&gt; # … with 5 more variables: Date5 &lt;chr&gt;, Month &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   Year &lt;dbl&gt;, Day &lt;dbl&gt;, Month2 &lt;chr&gt;</span></span>
<span><span class="co">#&gt; # ℹ Use `colnames()` to see all variable names</span></span></code></pre></div>
</div>
<div id="functions-for-date-variables-s" class="section level3" number="13.4.2">
<h3>
<span class="header-section-number">13.4.2</span> Functions for <code>&lt;date&gt;</code> Variables S<a class="anchor" aria-label="anchor" href="#functions-for-date-variables-s"><i class="fas fa-link"></i></a>
</h3>
</div>
<div id="chapexercise-11-S" class="section level3" number="13.4.3">
<h3>
<span class="header-section-number">13.4.3</span> Chapter Exercises S<a class="anchor" aria-label="anchor" href="#chapexercise-11-S"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>* Use a <code>lubridate</code> function with the <code>truncated</code> option to convert the <code>Month</code> variable to be in the <code>&lt;date&gt;</code> format.</li>
</ol>
<div class="sourceCode" id="cb421"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ds_df</span> <span class="op">&lt;-</span> <span class="va">ds_df</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Month <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="va">Month</span>, truncated <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ds_df</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>* Make a plot of the popularity of Data Science through Time. Add a smoother to your plot. What patterns do you notice?</li>
</ol>
<div class="sourceCode" id="cb422"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ds_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Month</span>, y <span class="op">=</span> <span class="va">Data_Science</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using method = 'loess' and formula 'y ~ x'</span></span></code></pre></div>
<div class="inline-figure"><img src="11-lubridate_files/figure-html/unnamed-chunk-28-1.png" width="672"></div>
<div class="sourceCode" id="cb423"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## it's like super popular!!!!</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>* On Google Trends, Enter in a search term, and change the Time dropdown menu to be 2004-present. Then, enter in a second search term that you want to compare. You can also change the country if you want to (or, you can keep the country as United States).</li>
</ol>
<p>My search terms will be “super smash” and “animal crossing”, but yours should be something that interests you!</p>
<p>In the top-right window of the graph, you should click the down arrow to download the data set. Delete the first two rows of your data set (either in Excel or <code>R</code>), read in the data set, and change the date variable so that it’s in a Date format.</p>
<div class="sourceCode" id="cb424"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">videogame_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data/smash_animal_crossing.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 203 Columns: 3</span></span>
<span><span class="co">#&gt; ── Column specification ────────────────────────────────────</span></span>
<span><span class="co">#&gt; Delimiter: ","</span></span>
<span><span class="co">#&gt; chr (1): Month</span></span>
<span><span class="co">#&gt; dbl (2): super_smash, animal_crossing</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ℹ Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">#&gt; ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span><span class="va">videogame_df</span> <span class="op">&lt;-</span> <span class="va">videogame_df</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>date <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="va">Month</span>, truncated <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>* Make a plot of your Popularity variables through time. <strong>Hint</strong>: Does the data set need to be tidied at all first?</li>
</ol>
<div class="sourceCode" id="cb425"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">videogame_long</span> <span class="op">&lt;-</span> <span class="va">videogame_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"super_smash"</span>, <span class="st">"animal_crossing"</span><span class="op">)</span>,</span>
<span>                              names_to <span class="op">=</span> <span class="st">"game"</span>,</span>
<span>                              values_to <span class="op">=</span> <span class="st">"popularity"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">videogame_long</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, </span>
<span>                                  y <span class="op">=</span> <span class="va">popularity</span>,</span>
<span>                                  colour <span class="op">=</span> <span class="va">game</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_colour_viridis_d</a></span><span class="op">(</span>begin <span class="op">=</span> <span class="fl">0</span>, end <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="11-lubridate_files/figure-html/unnamed-chunk-30-1.png" width="672"></div>
<ol start="5" style="list-style-type: decimal">
<li><p>* Using your data set that explored a variable or two from 2004 through now, make a table of the <strong>average</strong> popularity for each year. <strong>Hint</strong>: You’ll need a lubridate function to extract the year variable from the date object.</p></li>
<li><p>* Clear your search and now enter a search term that you’d like to investigate for the past 90 days. Mine will be “pittsburgh steelers” but, again, yours should be something that interests you.</p></li>
</ol>
<p>Again, click the download button again and read in the data to <code>R</code>. Convert the date variable to be in <code>&lt;date&gt;</code> format.</p>
<div class="sourceCode" id="cb426"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">steelers_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data/steelers.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 91 Columns: 2</span></span>
<span><span class="co">#&gt; ── Column specification ────────────────────────────────────</span></span>
<span><span class="co">#&gt; Delimiter: ","</span></span>
<span><span class="co">#&gt; chr (1): Day</span></span>
<span><span class="co">#&gt; dbl (1): Steelers</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ℹ Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">#&gt; ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span><span class="va">steelers_df</span> <span class="op">&lt;-</span> <span class="va">steelers_df</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>day_var <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">mdy</a></span><span class="op">(</span><span class="va">Day</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<ol start="7" style="list-style-type: decimal">
<li>* Make a plot of your popularity variable through time, adding a smoother.</li>
</ol>
<div class="sourceCode" id="cb427"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">steelers_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">day_var</span>, y <span class="op">=</span> <span class="va">Steelers</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Popularity"</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using method = 'loess' and formula 'y ~ x'</span></span></code></pre></div>
<div class="inline-figure"><img src="11-lubridate_files/figure-html/unnamed-chunk-32-1.png" width="672"></div>
</div>
</div>
<div id="rcode-11" class="section level2" number="13.5">
<h2>
<span class="header-section-number">13.5</span> Non-Exercise <code>R</code> Code<a class="anchor" aria-label="anchor" href="#rcode-11"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb428"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org">lubridate</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/now.html">today</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/now.html">now</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/">here</a></span><span class="op">)</span></span>
<span><span class="va">holiday_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data/animal_crossing_holidays.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">holiday_df</span></span>
<span><span class="va">holiday_df</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Date_test <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">dmy</a></span><span class="op">(</span><span class="va">Date1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Date_test</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">holiday_df</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Date_test <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">mdy</a></span><span class="op">(</span><span class="va">Date2</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Date_test</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">holiday_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Date1</span>, y <span class="op">=</span> <span class="va">Holiday</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">holiday_df</span> <span class="op">&lt;-</span> <span class="va">holiday_df</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Date_test_plot <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">dmy</a></span><span class="op">(</span><span class="va">Date1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Date_test_plot</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">holiday_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Date_test_plot</span>, y <span class="op">=</span> <span class="va">Holiday</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">holiday_df</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Date_test2 <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/make_datetime.html">make_date</a></span><span class="op">(</span>year <span class="op">=</span> <span class="va">Year</span>,</span>
<span>                                             month <span class="op">=</span> <span class="va">Month</span>,</span>
<span>                                             day <span class="op">=</span> <span class="va">Day</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Date_test2</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">holiday_df</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Date_test2 <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/make_datetime.html">make_date</a></span><span class="op">(</span>year <span class="op">=</span> <span class="va">Year</span>,</span>
<span>                                             month <span class="op">=</span> <span class="va">Month2</span>,</span>
<span>                                             day <span class="op">=</span> <span class="va">Day</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Date_test2</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## install.packages("quantmod")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.quantmod.com">quantmod</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="st">"2011-01-01"</span><span class="op">)</span></span>
<span><span class="va">end</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="st">"2021-5-19"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/quantmod/man/getSymbols.html">getSymbols</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AAPL"</span>, <span class="st">"NTDOY"</span>, <span class="st">"CMG"</span>, <span class="st">"SPY"</span><span class="op">)</span>, src <span class="op">=</span> <span class="st">"yahoo"</span>,</span>
<span>           from <span class="op">=</span> <span class="va">start</span>, to <span class="op">=</span> <span class="va">end</span><span class="op">)</span></span>
<span></span>
<span><span class="va">date_tib</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/zoo/man/index.html">index</a></span><span class="op">(</span><span class="va">AAPL</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>start_date <span class="op">=</span> <span class="va">value</span><span class="op">)</span></span>
<span><span class="va">app_tib</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="va">AAPL</span><span class="op">)</span></span>
<span><span class="va">nint_tib</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="va">NTDOY</span><span class="op">)</span></span>
<span><span class="va">chip_tib</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="va">CMG</span><span class="op">)</span></span>
<span><span class="va">spy_tib</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="va">SPY</span><span class="op">)</span></span>
<span><span class="va">all_stocks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_cols</a></span><span class="op">(</span><span class="va">date_tib</span>, <span class="va">app_tib</span>, <span class="va">nint_tib</span>, <span class="va">chip_tib</span>, <span class="va">spy_tib</span><span class="op">)</span></span>
<span></span>
<span><span class="va">stocks_long</span> <span class="op">&lt;-</span> <span class="va">all_stocks</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">start_date</span>, <span class="va">AAPL.Adjusted</span>, <span class="va">NTDOY.Adjusted</span>,</span>
<span>                      <span class="va">CMG.Adjusted</span>, <span class="va">SPY.Adjusted</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">5</span>, names_to <span class="op">=</span> <span class="st">"Stock_Type"</span>, values_to <span class="op">=</span> <span class="st">"Price"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Stock_Type <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_recode.html">fct_recode</a></span><span class="op">(</span><span class="va">Stock_Type</span>,</span>
<span>                                 Apple <span class="op">=</span> <span class="st">"AAPL.Adjusted"</span>,</span>
<span>                                 Nintendo <span class="op">=</span> <span class="st">"NTDOY.Adjusted"</span>,</span>
<span>                                 Chipotle <span class="op">=</span> <span class="st">"CMG.Adjusted"</span>,</span>
<span>                                 `S &amp; P 500` <span class="op">=</span> <span class="st">"SPY.Adjusted"</span></span>
<span>                                 <span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="va">stocks_long</span><span class="op">)</span></span>
<span><span class="va">stocks_sp</span> <span class="op">&lt;-</span> <span class="va">stocks_long</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Stock_Type</span> <span class="op">==</span> <span class="st">"S &amp; P 500"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">stocks_sp</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">start_date</span>, y <span class="op">=</span> <span class="va">Price</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">stocks_long</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>year_stock <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/year.html">year</a></span><span class="op">(</span><span class="va">start_date</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">stocks_long</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>month_stock <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/month.html">month</a></span><span class="op">(</span><span class="va">start_date</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">stocks_long</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>day_stock <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/day.html">mday</a></span><span class="op">(</span><span class="va">start_date</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">mdy</a></span><span class="op">(</span><span class="st">"November 4, 2020"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/day.html">yday</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span></span>
<span><span class="va">stocks_long</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>day_in_year <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/day.html">yday</a></span><span class="op">(</span><span class="va">start_date</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">stocks_long</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>day_of_week <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/day.html">wday</a></span><span class="op">(</span><span class="va">start_date</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">stocks_long</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>day_of_week <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/day.html">wday</a></span><span class="op">(</span><span class="va">start_date</span>,</span>
<span>                                          label <span class="op">=</span> <span class="cn">TRUE</span>, abbr <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="merging-with-dplyr.html"><span class="header-section-number">12</span> Merging with dplyr</a></div>
<div class="next"><a href="text-data-with-tidytext-and-stringr.html"><span class="header-section-number">14</span> Text Data with tidytext and stringr</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#dates-with-lubridate"><span class="header-section-number">13</span> Dates with lubridate</a></li>
<li>
<a class="nav-link" href="#converting-variables-to-date"><span class="header-section-number">13.1</span> Converting Variables to &lt;date&gt;</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#from-chr-to-date"><span class="header-section-number">13.1.1</span> From &lt;chr&gt; to &lt;date&gt;</a></li>
<li><a class="nav-link" href="#making-a-date-variable-from-date-components"><span class="header-section-number">13.1.2</span> Making a &lt;date&gt; variable from Date Components</a></li>
<li><a class="nav-link" href="#exercise-11-1"><span class="header-section-number">13.1.3</span> Exercises</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#functions-for-date-variables"><span class="header-section-number">13.2</span> Functions for &lt;date&gt; Variables</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#year-month-and-mday"><span class="header-section-number">13.2.1</span> year(), month(), and mday()</a></li>
<li><a class="nav-link" href="#yday-and-wday"><span class="header-section-number">13.2.2</span> yday() and wday()</a></li>
<li><a class="nav-link" href="#exercise-11-2"><span class="header-section-number">13.2.3</span> Exercises</a></li>
</ul>
</li>
<li><a class="nav-link" href="#chapexercise-11"><span class="header-section-number">13.3</span> Chapter Exercises</a></li>
<li>
<a class="nav-link" href="#solutions-11"><span class="header-section-number">13.4</span> Exercise Solutions</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#converting-variables-to-date-s"><span class="header-section-number">13.4.1</span> Converting Variables to &lt;date&gt; S</a></li>
<li><a class="nav-link" href="#functions-for-date-variables-s"><span class="header-section-number">13.4.2</span> Functions for &lt;date&gt; Variables S</a></li>
<li><a class="nav-link" href="#chapexercise-11-S"><span class="header-section-number">13.4.3</span> Chapter Exercises S</a></li>
</ul>
</li>
<li><a class="nav-link" href="#rcode-11"><span class="header-section-number">13.5</span> Non-Exercise R Code</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>STAT 234: Data Science</strong>" was written by Matt Higham. It was last built on 2022-09-14.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
